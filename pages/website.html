<!DOCTYPE html>
<html class="inverted" lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="theme-color" content="#ffffff">
<title>Static Website Generator - joshj.dev</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Josh's website and portfolio.">
<link rel="stylesheet" type="text/css" href="/files/website.css">
<!-- Icons-->
<link rel="apple-touch-icon" sizes="180x180" href="/files/icons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/files/icons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/files/icons/favicon-16x16.png">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #cccccc; background-color: #303030; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ffcfaf; } /* Alert */
    code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
    code span.at { } /* Attribute */
    code span.bn { color: #dca3a3; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #f0dfaf; } /* ControlFlow */
    code span.ch { color: #dca3a3; } /* Char */
    code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
    code span.co { color: #7f9f7f; } /* Comment */
    code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
    code span.do { color: #7f9f7f; } /* Documentation */
    code span.dt { color: #dfdfbf; } /* DataType */
    code span.dv { color: #dcdccc; } /* DecVal */
    code span.er { color: #c3bf9f; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #c0bed1; } /* Float */
    code span.fu { color: #efef8f; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
    code span.kw { color: #f0dfaf; } /* Keyword */
    code span.op { color: #f0efd0; } /* Operator */
    code span.ot { color: #efef8f; } /* Other */
    code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
    code span.sc { color: #dca3a3; } /* SpecialChar */
    code span.ss { color: #cc9393; } /* SpecialString */
    code span.st { color: #cc9393; } /* String */
    code span.va { } /* Variable */
    code span.vs { color: #cc9393; } /* VerbatimString */
    code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */
  </style>
</head>
<body>
<h1 id="static-website-generator">Static Website Generator</h1>
<p><div class="fancyPositioning"></p>
<p><intro date="04/09/2021"></p>
<div class="picture-left">
<figure>
<img src="/files/images/website.png" alt="" /><figcaption>This website.</figcaption>
</figure></div>
<div class="tleft">
<p>This website uses my own static site generator and GitHub actions to convert markdown into HTML using pandoc automatically when any pages are updated.</p>
<p></intro></p>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#implementation">Implementation</a></li>
<li><a href="#website-features">Website features</a></li>
<li><a href="#how-it-works">How it works</a></li>
<li><a href="#github-repository">GitHub Repository</a></li>
</ul>
<p></div>
</div></p>
<h2 id="introduction">Introduction</h2>
<p>This website uses a static site generator script written in python that converts markdown files into HTML using pandoc and Jinja templates. The repository is set up to use GitHub actions to automatically run the scripts only if the markdown portion of the site is updated. If changes are made to any other parts of the repository, then the website is not updated.</p>
<h2 id="implementation">Implementation</h2>
<p>The markdown pages are loaded into the strings where any relative paths to images are replaced with paths relative to the base of the directory. These are then converted into HTML using <a href="https://pypi.org/project/pypandoc/">pypandoc</a>. Since these are only the raw HTML without any site specific code (CSS and website UI etc.) jinja templates are used which contain the website UI. This results in the full page being rendered and this is put into the pages section of the website.</p>
<p>The index page then needs to be updated as it contains a brief overview of the projects. Therefore we take a section of each of the markdown files and load it into another jinja template for the index of the site. This results in a simple website that contains everything needed to host my portfolio.</p>
<p>Another similar script is used to generate my CV from a YAML file, a jinja template, and some CSS.</p>
<h2 id="website-features">Website features</h2>
<p>This website is based off of <a href="https://thebestmotherfucking.website/">https://thebestmotherfucking.website/</a> with some changes. It has a nice short invert script that lets you switch to dark or light mode based on the OS settings (or by clicking the button). It can run on literally anything without losing the look of the website by using simple CSS. The website has different behavior for mobile devices yet retains a simple yet consistent styling.</p>
<p>The website itself is also very small. The images are kept to as few kB as possible and the CV is generated into HTML instead of hosting a PDF. These are attempts to minimise the carbon footprint of my website. At the time of writing all of the pages weigh less than 35kB!</p>
<p><div class="fancyPositioning"></p>
<div class="picture-left">
<figure>
<img src="/files/images/website-wildfire.jpg" alt="" /><figcaption>Running on a HTC Wildfire!</figcaption>
</figure></div>
<div class="tleft">
<p>In cases where the invert button isn’t supported, it is specifically designed to not appear. In this case you retain the rest of the styling.</p>
<p>This was tested using a HTC Wildfire using Android 2.2 (Froyo). This phone is so weak I was never able to get it to run Angry Birds back in the day! As you can see, the styling is simple enough that the website looks identical to on other devices. If you scroll up you find the “Go to homepage” but not the “Invert mode” button as the web browser used on this device doesn’t support very recent versions of CSS.</p>
<p><em>Note: image is compressed to 11kB to reduce the carbon footprint of my website.</em></p>
<p></div>
</div></p>
<h2 id="how-it-works">How it works</h2>
<p>A reusable GitHub actions workflow is used for generating the website and CV. This means that it can be called from other workflows. It takes a <code>branch</code> to run on (and commit the changes back to) and an <code>update</code> string specifying which of either the website or CV should be updated:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode yml"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="fu">on</span><span class="kw">:</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a><span class="at">  </span><span class="fu">workflow_call</span><span class="kw">:</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a><span class="at">    </span><span class="fu">inputs</span><span class="kw">:</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a><span class="at">      </span><span class="fu">branch</span><span class="kw">:</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a><span class="at">        </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Branch to run on</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true"></a><span class="at">        </span><span class="fu">required</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true"></a><span class="at">      </span><span class="fu">update</span><span class="kw">:</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true"></a><span class="at">        </span><span class="fu">description</span><span class="kw">:</span><span class="at"> What to update (&#39;cv&#39; or &#39;website&#39;)</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true"></a><span class="at">        </span><span class="fu">required</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true"></a><span class="at">    </span><span class="fu">secrets</span><span class="kw">:</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true"></a><span class="at">      </span><span class="fu">GIT_SECRET</span><span class="kw">:</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true"></a><span class="at">        </span><span class="fu">required</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span></code></pre></div>
<p>Concurrency is used so that only one workflow runs on a branch at once. This avoids the issue of the CV and website workflows trying to commit changes to the same branch at the same time.</p>
<p>If the branch isn’t specified then it defaults to the HEAD of branch the workflow was called on and if that isn’t available then it will be the pull request reference (e.g. <code>refs/pull/31/merge</code>).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode yml"><code class="sourceCode yaml"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="fu">concurrency</span><span class="kw">:</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a><span class="at">  </span><span class="fu">group</span><span class="kw">:</span><span class="at"> ${{ inputs.branch || github.head_ref || github.ref }}</span></span></code></pre></div>
<p>The steps are as follows:</p>
<ol type="1">
<li>Checkout the repo on the correct branch.</li>
<li>Set up python and restore pip dependencies before trying to install them.</li>
<li>Install <code>pandoc</code> if updating the website.</li>
<li>Update the resource specified by <code>inputs.update</code>.</li>
<li>Commit and push the changes.</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="sourceCode yml"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="fu">jobs</span><span class="kw">:</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a><span class="at">  </span><span class="fu">build-and-deploy</span><span class="kw">:</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a><span class="at">    </span><span class="fu">runs-on</span><span class="kw">:</span><span class="at"> ubuntu-latest</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a><span class="at">    </span><span class="fu">steps</span><span class="kw">:</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/checkout@v3</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true"></a><span class="at">      </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true"></a><span class="at">        </span><span class="fu">ref</span><span class="kw">:</span><span class="at"> ${{ inputs.branch || github.head_ref || github.ref }}</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true"></a><span class="at">        </span><span class="fu">persist-credentials</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span><span class="co"> # otherwise token used is the GITHUB_TOKEN, instead of your personal access token.</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true"></a><span class="at">        </span><span class="fu">fetch-depth</span><span class="kw">:</span><span class="at"> </span><span class="dv">0</span><span class="co"> # otherwise, there would be errors pushing refs to the destination repository.</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Setup python</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true"></a><span class="at">      </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/setup-python@v4</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true"></a><span class="at">      </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true"></a><span class="at">        </span><span class="fu">python-version</span><span class="kw">:</span><span class="at"> </span><span class="fl">3.11</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true"></a><span class="at">        </span><span class="fu">cache</span><span class="kw">:</span><span class="at"> </span><span class="st">&#39;pip&#39;</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Install dependencies</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true"></a><span class="fu">      run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true"></a>          pip3 install -r build_scripts/requirements.txt</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Install pandoc</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true"></a><span class="at">      </span><span class="fu">if</span><span class="kw">:</span><span class="at"> inputs.update == &#39;website&#39;</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true"></a><span class="fu">      run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true"></a>          sudo apt install pandoc</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Generate CV from YAML</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true"></a><span class="at">      </span><span class="fu">if</span><span class="kw">:</span><span class="at"> inputs.update == &#39;cv&#39;</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true"></a><span class="fu">      run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true"></a>          python3 build_scripts/generate_cv.py -c files/src/cv.yaml -t files/templates/cv.html.template -o pages/CV-Josh-Jennings.html</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Generate webpages from markdown files</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true"></a><span class="at">      </span><span class="fu">if</span><span class="kw">:</span><span class="at"> inputs.update == &#39;website&#39;</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true"></a><span class="fu">      run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true"></a>        python3 build_scripts/generate_webpages.py -m files/src/ -t files/templates/ -s /files/website.css -o pages/ -f /files</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Commit changes</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true"></a><span class="fu">      run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true"></a>        git pull</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true"></a>        git config --local user.email &quot;41898282+github-actions[bot]@users.noreply.github.com&quot;</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true"></a>        git config --local user.name &quot;github-actions[bot]&quot;</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true"></a>        git add .</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true"></a>        git commit -m &quot;Update ${{ inputs.update }} - $(date).&quot;</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Push changes ready for Github Pages to deploy</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true"></a><span class="at">      </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> ad-m/github-push-action@master</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true"></a><span class="at">      </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true"></a><span class="at">        </span><span class="fu">github_token</span><span class="kw">:</span><span class="at"> ${{ secrets.GIT_SECRET }}</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true"></a><span class="at">        </span><span class="fu">branch</span><span class="kw">:</span><span class="at"> ${{ inputs.branch || github.head_ref || github.ref }}</span></span></code></pre></div>
<p>An example of how this workflow is used can be seen below in <code>update-cv.yml</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode yml"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="fu">name</span><span class="kw">:</span><span class="at"> Build CV</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a><span class="fu">on</span><span class="kw">:</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a><span class="at">  </span><span class="fu">push</span><span class="kw">:</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a><span class="at">    </span><span class="fu">branches</span><span class="kw">:</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a><span class="at">      </span><span class="kw">-</span><span class="at"> master</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a><span class="at">    </span><span class="fu">paths</span><span class="kw">:</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&#39;files/src/cv.yaml&#39;</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="st">&#39;files/templates/cv.html.template&#39;</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true"></a><span class="fu">jobs</span><span class="kw">:</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true"></a><span class="at">  </span><span class="fu">build-and-deploy-cv</span><span class="kw">:</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true"></a><span class="at">    </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Build and deploy CV</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true"></a><span class="at">    </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> joshjennings98/joshjennings98.github.io/.github/workflows/update.yml@master</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true"></a><span class="at">    </span><span class="fu">secrets</span><span class="kw">:</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true"></a><span class="at">      </span><span class="fu">GIT_SECRET</span><span class="kw">:</span><span class="at"> ${{ secrets.GITHUB_TOKEN }}</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true"></a><span class="at">    </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true"></a><span class="at">      </span><span class="fu">update</span><span class="kw">:</span><span class="at"> cv</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true"></a><span class="at">      </span><span class="fu">branch</span><span class="kw">:</span><span class="at"> ${{ github.head_ref || github.ref }}</span></span></code></pre></div>
<h2 id="github-repository">GitHub Repository</h2>
<p>The full project can be viewed on <a href="https://github.com/joshjennings98/joshjennings98.github.io">GitHub.</a></p>
</body>
</html>
<a id=title href="/"><div id="test">Go to homepage</div></a>
<footer><div><a href=#top>Back to top</a></div><br><div id="wcb" class="carbonbadge wcb"></div><script src="https://unpkg.com/website-carbon-badges@1.1.3/b.min.js" defer></script></footer>
<script src="../files/invert.js" type="text/javascript"></script>
</body>
</html>