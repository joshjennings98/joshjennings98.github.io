<html><head><meta content="width=device-width, initial-scale=1.0" name="viewport"><link href="static/favicon.ico" rel="icon" type="image/x-icon"><link href="static/website.css" rel="stylesheet"><title>joshj.dev</title><base href="https://joshj.dev"><link as="font" crossorigin href="static/AveriaLibre.woff2" rel="preload" type="font/woff2"><link as="font" crossorigin href="static/IosevkaSmall.woff2" rel="preload" type="font/woff2"><meta content="#040204" name="theme-color"></head><body><input class="theme-checkbox" hidden id="theme" type="checkbox"><main><div><section><header><h1><a href="#">Josh's Website</a></h1><nav><ul class="nav"><li><a href="#">Home</a></li><li><a href="#blog">Blog</a></li><li><a href="http://github.com/joshjennings98" rel="noopener noreferrer" target="_blank">GitHub</a></li><li><label class="page-button" for="theme" title="Toggle stars theme">Theme</label></li></ul></nav></header><div><article class="page" id="blog"><h2>Blog</h2><p>This page contains blog posts I have written. There is a mixture of posts about programming (and programming adjacent) stuff and maybe some dev logs.</p><ul><li><a href="#website">How I made this website with no JavaScript</a></li><li><a href="#fsharp-neural-network">Understanding neural networks using F#</a></li></ul><p>I also have a couple of project showcases:</p><ul><li><a href="#backend-demos"><strong>Backend Demo Tool:</strong></a><ul><li>A presentation tool to help with running backend demos.</li><li>Written in Go using HTMX and websockets.  </li></ul></li></ul><p>More projects can be found on my <a href="https://github.com/joshjennings98">Github page</a>.</p><footer><nav><a href="#blog">Back to top</a></nav></footer></article><article class="page" id="fsharp-neural-network"><h2>Understand How A Neural Network Works Using F#</h2><p>In this post I will show off a small F# library that allows for the creation of scalable fully-connected <a href="https://en.wikipedia.org/wiki/Neural_network_(machine_learning)">neural networks</a>. I will use it to explain how forward and back propagation work via code examples. If you find any mistakes let me know and I will make the necessary changes.</p><p>Combining the creation of this library with <a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/">guides about backpropagation</a> helped me a lot with understanding neural networks and how they worked. I would recommend this as a simple project that could be helpful to learn new languages (especially functional ones) as it requires the use of a lot of fundamental programming language concepts.</p><h3>Forward Propagation</h3><p><a href="https://en.wikipedia.org/wiki/Neural_network_(machine_learning)">Neural networks</a> consist of interconnected nodes organised in layers. They learn by adjusting the weights of connections between neurons during training, using techniques like forward and backward propagation to minimise the difference between predicted and actual outputs. By training the network on labeled data, neural networks can generalise patterns to make predictions on new data.</p><h4>Single Layer Forward Propagation</h4><p>A single forward propagation though a layer just involves multiplying the inputs to the layer with the layer weights (their dot product). After this, they are summed and the bias added before having the activation layer for that function applied. This will then be calculated for every layer using the outputs of the previous layer as the inputs to the next.</p><p>This can be represented with the following equation:</p><p><img loading='lazy' alt="forward propagation" src="./static/assets/nn1.svg"></p><p>The number of neurons in the previous layer is:</p><p><img loading='lazy' alt="number of neurons" src="./static/assets/nn2.svg"></p><p>The weight of the connection between neuron <code>i</code> in the previous layer and neuron <code>j</code> in the current layer is:</p><p><img loading='lazy' alt="weights between layers" src="./static/assets/nn3.svg"></p><p>The output of neuron <code>i</code> in the previous layer is:</p><p><img loading='lazy' alt="outputs of layers" src="./static/assets/nn4.svg"></p><p>The bias term for neuron <code>j</code> in the current layer:</p><p><img loading='lazy' alt="biases of layers" src="./static/assets/nn5.svg"></p><p>How can we represent this in F#? It is simple, we just split up the equation into several parts and pipe the output from one part to another. The <code>List.map</code> applies the function to every element in the list:</p><pre class="fsharp"><code><span style="background: linear-gradient(to right , #E68 0ch, #E68 3ch, white 3ch, white 30ch, #a6e22e 30ch, #a6e22e 36ch, white 36ch, white 48ch, #a6e22e 48ch, #a6e22e 64ch, white 64ch, white 75ch, #a6e22e 75ch, #a6e22e 86ch, white 86ch, white 101ch, #a6e22e 101ch, #a6e22e 112ch, white 112ch, white 115ch, #a6e22e 115ch, #a6e22e 127ch, white 127ch, white 128ch); -webkit-background-clip: text">let forwardSingleLayer (bias : float) (weights : float list list) (inputs : float list) (activation : Activation) : float list =</span>
<span style="background: linear-gradient(to right , white 0ch, white 11ch); -webkit-background-clip: text">    weights</span>
<span style="background: linear-gradient(to right , white 0ch, white 4ch, #f92672 4ch, #f92672 6ch, white 6ch, white 7ch, #fd971f 7ch, #fd971f 11ch, white 11ch, white 17ch, #78dce8 17ch, #78dce8 20ch, white 20ch, white 26ch, #f92672 26ch, #f92672 28ch, white 28ch, white 29ch, #fd971f 29ch, #fd971f 33ch, white 33ch, white 55ch); -webkit-background-clip: text">    |&gt; List.map (fun list -&gt; List.map2 (*) list inputs)</span>
<span style="background: linear-gradient(to right , white 0ch, white 4ch, #f92672 4ch, #f92672 6ch, white 6ch, white 7ch, #fd971f 7ch, #fd971f 11ch, white 11ch, white 17ch, #78dce8 17ch, #78dce8 20ch, white 20ch, white 26ch, #f92672 26ch, #f92672 28ch, white 28ch, white 29ch, #fd971f 29ch, #fd971f 33ch, white 33ch, white 50ch); -webkit-background-clip: text">    |&gt; List.map (fun list -&gt; List.sum list + bias)</span>
<span style="background: linear-gradient(to right , white 0ch, white 4ch, #f92672 4ch, #f92672 6ch, white 6ch, white 31ch); -webkit-background-clip: text">    |&gt; activateLayer activation</span></code></pre><p>What is <code>activateLayer</code>? It is a function that is applied to each of the weighted sums to introduce non-linearity into the network:</p><p><img loading='lazy' alt="activation function" src="./static/assets/nn6.svg"></p><p>The <code>activateLayer</code> function takes an activation and maps the corresponding activation function across the list before returning it. A small part of this function can be see below:</p><pre class="fsharp"><code><span style="background: linear-gradient(to right , #E68 0ch, #E68 3ch, white 3ch, white 31ch, #a6e22e 31ch, #a6e22e 42ch, white 42ch, white 52ch, #a6e22e 52ch, #a6e22e 63ch, white 63ch, white 66ch, #a6e22e 66ch, #a6e22e 78ch, white 78ch, white 79ch); -webkit-background-clip: text">let activateLayer (activation : Activation) (input : float list) : float list =</span>
<span style="background: linear-gradient(to right , white 0ch, white 4ch, #E68 4ch, #E68 9ch, white 9ch, white 21ch, #E68 21ch, #E68 25ch); -webkit-background-clip: text">    match activation with</span>
<span style="background: linear-gradient(to right , white 0ch, white 14ch, #f92672 14ch, #f92672 16ch); -webkit-background-clip: text">    | Sigmoid -&gt;</span>
<span style="background: linear-gradient(to right , white 0ch, white 8ch, #fd971f 8ch, #fd971f 12ch, white 12ch, white 18ch, #78dce8 18ch, #78dce8 21ch, white 21ch, white 24ch, #f92672 24ch, #f92672 26ch, white 26ch, white 27ch, #A7C 27ch, #A7C 30ch, white 30ch, white 34ch, #A7C 34ch, #A7C 37ch, white 37ch, white 55ch); -webkit-background-clip: text">        List.map (fun x -&gt; 1.0 / (1.0 + exp(-x))) input</span>
<span style="background: linear-gradient(to right , white 0ch, white 11ch, #f92672 11ch, #f92672 13ch); -webkit-background-clip: text">    | Relu -&gt;</span>
<span style="background: linear-gradient(to right , white 0ch, white 8ch, #fd971f 8ch, #fd971f 12ch, white 12ch, white 18ch, #78dce8 18ch, #78dce8 21ch, white 21ch, white 24ch, #f92672 24ch, #f92672 26ch, white 26ch, white 33ch, #A7C 33ch, #A7C 36ch, white 36ch, white 43ch); -webkit-background-clip: text">        List.map (fun x -&gt; max x 0.0) input</span></code></pre><h4>Full Forward Propagation</h4><p>That was a single layer, the process for the full forward propagation needs to apply the previous functions to every layer in the network using the outputs from the previous layer as the inputs to the next. We do this via following steps:</p><ol><li>First create an empty list the size of the network.</li><li>Fold though the empty list using the accumulator to store the intermediate activated and unactivated output of all layers. This is done with the <code>forwardSingleLayer</code> function from before.</li><li>Then add an extra layer containing only 1.0s to the end of the forward propagated output. This makes it easier when doing back propagation.<pre class="fsharp"><code><span style="background: linear-gradient(to right , #E68 0ch, #E68 3ch, white 3ch, white 29ch, #a6e22e 29ch, #a6e22e 40ch, white 40ch, white 51ch, #a6e22e 51ch, #a6e22e 62ch, white 62ch, white 73ch, #a6e22e 73ch, #a6e22e 84ch, white 84ch, white 87ch, #a6e22e 87ch, #a6e22e 104ch, white 104ch, white 105ch); -webkit-background-clip: text">let forwardFull (parameters : Parameters) (inputs : float list) (layers : Layer list) : float list list =</span>
<span style="background: linear-gradient(to right , white 0ch, white 4ch, #fd971f 4ch, #fd971f 8ch, white 8ch, white 30ch); -webkit-background-clip: text">    List.init layers.Length id</span>
<span style="background: linear-gradient(to right , white 0ch, white 4ch, #f92672 4ch, #f92672 6ch, white 6ch, white 7ch, #fd971f 7ch, #fd971f 11ch, white 11ch, white 18ch, #78dce8 18ch, #78dce8 21ch, white 21ch, white 28ch, #a6e22e 28ch, #a6e22e 44ch, white 44ch, white 52ch, #f92672 52ch, #f92672 54ch); -webkit-background-clip: text">    |&gt; List.fold (fun (acc : float list list) index -&gt;</span>
<span style="background: linear-gradient(to right , white 0ch, white 8ch, #E68 8ch, #E68 11ch, white 11ch, white 41ch); -webkit-background-clip: text">        let biases, weights, activation =</span>
<span style="background: linear-gradient(to right , white 0ch, white 92ch); -webkit-background-clip: text">            parameters.biases.[index], parameters.weights.[index], layers.[index].activation</span>
<span style="background: linear-gradient(to right , white 0ch, white 48ch, #A7C 48ch, #A7C 49ch, white 49ch, white 63ch, #f92672 63ch, #f92672 64ch, white 64ch, white 69ch); -webkit-background-clip: text">        [forwardSingleLayer biases weights acc.[0] activation] @ acc)</span>
<span style="background: linear-gradient(to right , white 0ch, white 20ch); -webkit-background-clip: text">            [inputs]</span>
<span style="background: linear-gradient(to right , white 0ch, white 4ch, #f92672 4ch, #f92672 6ch, white 6ch, white 7ch, #fd971f 7ch, #fd971f 11ch, white 11ch, white 20ch, #fd971f 20ch, #fd971f 24ch, white 24ch, white 31ch, #fd971f 31ch, #fd971f 35ch, white 35ch, white 66ch); -webkit-background-clip: text">    |&gt; List.append [List.init (List.last layers).outputDims float]</span></code></pre></li></ol><p>This will result in a list of output values that will probably be completely wrong. What we now want to do is work out how wrong they are. We will then adjust all the weights in the network by how much they contributed to the error. Once this is done we can just repeat the forward propagation and error calculation and update steps until the error is sufficiently low. In the next section we will work out how to calculate the error.</p><h3>Calculating Error</h3><p>To calculate the error in the output, the output of forward propagation and the target output are passed to a function that calculates the loss or error.</p><pre class="fsharp"><code><span style="background: linear-gradient(to right , #E68 0ch, #E68 3ch, white 3ch, white 36ch, #a6e22e 36ch, #a6e22e 47ch, white 47ch, white 65ch, #a6e22e 65ch, #a6e22e 76ch, white 76ch, white 85ch, #a6e22e 85ch, #a6e22e 90ch, white 90ch, white 93ch, #a6e22e 93ch, #a6e22e 100ch, white 100ch, white 101ch); -webkit-background-clip: text">let getOverallError (targetOutputs : float list) (actualOutputs : float list) (loss : Loss) : float =</span>
<span style="background: linear-gradient(to right , white 0ch, white 17ch); -webkit-background-clip: text">    actualOutputs</span>
<span style="background: linear-gradient(to right , white 0ch, white 4ch, #f92672 4ch, #f92672 6ch, white 6ch, white 7ch, #fd971f 7ch, #fd971f 11ch, white 11ch, white 71ch); -webkit-background-clip: text">    |&gt; List.map2 (lossFunction loss targetOutputs.Length) targetOutputs</span>
<span style="background: linear-gradient(to right , white 0ch, white 4ch, #f92672 4ch, #f92672 6ch, white 6ch, white 7ch, #fd971f 7ch, #fd971f 11ch, white 11ch, white 15ch); -webkit-background-clip: text">    |&gt; List.sum</span></code></pre><p>A loss function (<code>L</code>) quantifies the difference between the predicted outputs (<code>y</code> with hat) of the network and the actual target values (<code>y</code>). This can be used to calculate the total error via the following equation:</p><p><img loading='lazy' alt="loss function" src="./static/assets/nn7.svg"></p><p>Here is how we can apply the loss function with F#. Similarly to the activation functions, the loss functions are supplied using pattern matching. In this case however, they return a function that can be applied wherever the particular value required instead of taking an returning a list. Part of <code>lossFunction</code> can be seen below. There are multiple loss functions that are supported, the ones you see here are mean squared error and mean absolute error:</p><pre class="fsharp"><code><span style="background: linear-gradient(to right , #E68 0ch, #E68 3ch, white 3ch, white 24ch, #a6e22e 24ch, #a6e22e 29ch, white 29ch, white 35ch, #a6e22e 35ch, #a6e22e 39ch, white 39ch, white 42ch, #a6e22e 42ch, #a6e22e 67ch, white 67ch, white 68ch); -webkit-background-clip: text">let lossFunction (loss : Loss) (n : int) : float -&gt; float -&gt; float =</span>
<span style="background: linear-gradient(to right , white 0ch, white 4ch, #E68 4ch, #E68 9ch, white 9ch, white 15ch, #E68 15ch, #E68 19ch); -webkit-background-clip: text">    match loss with</span>
<span style="background: linear-gradient(to right , white 0ch, white 10ch, #f92672 10ch, #f92672 12ch); -webkit-background-clip: text">    | MSE -&gt;</span>
<span style="background: linear-gradient(to right , white 0ch, white 8ch, #78dce8 8ch, #78dce8 11ch, white 11ch, white 26ch, #f92672 26ch, #f92672 28ch); -webkit-background-clip: text">        fun actual target -&gt;</span>
<span style="background: linear-gradient(to right , white 0ch, white 13ch, #A7C 13ch, #A7C 16ch, white 16ch, white 22ch, #f92672 22ch, #f92672 24ch, white 24ch, white 56ch, #A7C 56ch, #A7C 59ch); -webkit-background-clip: text">            (1.0 / (n |&gt; float)) * (actual - target) ** 2.0</span>
<span style="background: linear-gradient(to right , white 0ch, white 10ch, #f92672 10ch, #f92672 12ch); -webkit-background-clip: text">    | MAE -&gt;</span>
<span style="background: linear-gradient(to right , white 0ch, white 8ch, #78dce8 8ch, #78dce8 11ch, white 11ch, white 26ch, #f92672 26ch, #f92672 28ch); -webkit-background-clip: text">        fun actual target -&gt;</span>
<span style="background: linear-gradient(to right , white 0ch, white 13ch, #A7C 13ch, #A7C 16ch, white 16ch, white 22ch, #f92672 22ch, #f92672 24ch, white 24ch, white 58ch); -webkit-background-clip: text">            (1.0 / (n |&gt; float)) * (abs (actual - target))</span></code></pre><p>The choice of loss function <a href="https://machinelearningmastery.com/how-to-choose-loss-functions-when-training-deep-learning-neural-networks/">depends on the type of problem</a> being solved (e.g. mean square error for regression problems; mean absolute error for mostly Gaussian regression problems with outliers; or cross-entropy error for classification problems).</p><h3>Back Propagation</h3><p>Back propagation is more complex than the forward version. We need to go backwards through the network and modify each weight based on how much it contributed to the error. </p><h4>Output Layer</h4><p>For the output layer, we compute the derivative of the loss function with respect to the outputs. If <code>L</code> is the loss function and <code>o</code> represents a network output, the gradient is computed as:</p><p><img loading='lazy' alt="derivative of loss function with respect to the outputs" src="./static/assets/nn8.svg"></p><h4>Hidden Layers</h4><p>For the hidden layers, the individual deltas for each node in the previous layer are found by propagating the error backward from the output. This involves calculating the error contribution from each node to the subsequent layers, represented as:</p><p><img loading='lazy' alt="error contribution from each node to the subsequent layers" src="./static/assets/nn9.svg"></p><p>This formular calculates the error term for a neuron <code>j</code> by summing the contributions of errors from neurons in the subsequent layer <code>k</code>, weighted by the connection <code>w</code> between the neurons in each layer and multiplies it by the derivative of the loss function.</p><p></p><details> <summary> Click here to see how the chain rule is used to get the above equation </summary><p></p><p>The contribution of the weights to the error can be calculated using the chain rule. The <a href="https://en.wikipedia.org/wiki/Chain_rule">chain rule</a> is a formula that expresses the derivative of the composition of two differentiable functions <code>f</code> and <code>g</code> in terms of the derivatives of <code>f</code> and <code>g</code>. It states the following:</p><p><img loading='lazy' alt="the chain rule" src="./static/assets/chainrule.svg"></p><p>To see how it works there is some good information <a href="https://en.wikipedia.org/wiki/Chain_rule#Intuitive_explanation">on the wikipedia page</a></p><p>The chain rule is important in back propagation because it helps break down the calculation of how each weight affects the loss function into easier to manage components. Each weight's gradient is obtained by multiplying simpler derivatives through each layer. When updating the weights, the chain rule is applied as follows:</p><p><img loading='lazy' alt="how the chain rule applies to back propagation" src="./static/assets/nn13.svg"></p><p>Where:</p><p><img loading='lazy' alt="using chain rule in back propagation 1" src="./static/assets/nn14.svg"></p><p>is the sensitivity of the loss function to the output of a specific neuron <code>k</code>.</p><p><img loading='lazy' alt="using chain rule in back propagation 2" src="./static/assets/nn15.svg"></p><p>is the derivative of the output of neuron <code>k</code> with respect to its input, simplifying to the weight between <code>j</code> and <code>k</code>.</p><p><img loading='lazy' alt="using chain rule in back propagation 3" src="./static/assets/nn16.svg"></p><p>is the effect of weight on the input of neuron <code>j</code>, which is the derivative of the activation function of neuron <code>j</code>.</p><p>This makes it much easier to calculate the contribution of a specific weight to the error. The result of applying the chain rule (combined with the equation for calculating the contribution of a neuron to the error in a hidden layer) means that the derivative of the loss with respect to a specific weight is given by the much simpler equation:</p><p><img loading='lazy' alt="contribution of a weight to the error" src="./static/assets/nn9.svg"></p><p></p></details><p></p><p>This value is then used to update the weights. We multiply it by a learning rate that controls how large the weight updates are between runs:</p><p><img loading='lazy' alt="how to update the weight based on the error" src="./static/assets/nn12.svg"></p><p>With this we have modified the weights based on their contribution to the total error! This means that in subsequent forward propagations the error will be lower (for the same specific input). Later when we train the network, we will constantly be updating the weights and due to using lots of different inputs this contribution will fluctuate. </p><p>So how do we do this with F#? We first calculate the intermediate output sums. For the output layer, the only thing that needs to be done is for the derivatve of the loss function to applied to the outputs. For the hidden layers, we can utilise the chain rule. This simplifies the calculation so that the  the individual deltas for each node in the previous layer are found. Afterwards, the layer weights are taken and multiplied by their matching deltas. The values coming into each node are then summed.</p><p>The new weights are then calculated. This is simpler. The derivative of the activation function is found and then multiplied by the corresponding output delta sum. This is then multiplied by the output of of the previous layer resulting in a value corresponding to <code>learningRate * delta * outPrev</code>. This value is then subtracted from the corresponding weight as back propagation is defined.</p><p>The new weights and intermediate output deltas are then returned.</p><pre class="fsharp"><code><span style="background: linear-gradient(to right , #E68 0ch, #E68 3ch, white 3ch, white 40ch, #a6e22e 40ch, #a6e22e 51ch, white 51ch, white 60ch, #a6e22e 60ch, #a6e22e 65ch, white 65ch, white 82ch, #a6e22e 82ch, #a6e22e 88ch, white 88ch, white 105ch, #a6e22e 105ch, #a6e22e 116ch, white 116ch, white 131ch, #a6e22e 131ch, #a6e22e 135ch, white 135ch, white 156ch, #a6e22e 156ch, #a6e22e 172ch, white 172ch, white 187ch, #a6e22e 187ch, #a6e22e 208ch, white 208ch, white 219ch, #a6e22e 219ch, #a6e22e 230ch, white 230ch, white 233ch, #a6e22e 233ch, #a6e22e 263ch, white 263ch, white 264ch); -webkit-background-clip: text">let backPropSingleLayer (targetOutputs : float list) (loss : Loss) (learningRate : float) (backPropPart : float list) (layerIndex : int) (forwardPropParts : float list list) (allWeights : float list list list) (layers : Layer list) : float list list * float list =</span>
<span style="background: linear-gradient(to right ); -webkit-background-clip: text"></span>
<span style="background: linear-gradient(to right , white 0ch, white 4ch, #E68 4ch, #E68 7ch, white 7ch, white 36ch); -webkit-background-clip: text">    let intermediateOutputDeltaSum =</span>
<span style="background: linear-gradient(to right , white 0ch, white 8ch, #E68 8ch, #E68 10ch, white 10ch, white 24ch, #A7C 24ch, #A7C 25ch); -webkit-background-clip: text">        if layerIndex = 0</span>
<span style="background: linear-gradient(to right , white 0ch, white 8ch, #E68 8ch, #E68 12ch, white 12ch, white 13ch, lightgrey 13ch, lightgrey 28ch); -webkit-background-clip: text">        then // Output layer</span>
<span style="background: linear-gradient(to right , white 0ch, white 43ch, #A7C 43ch, #A7C 44ch, white 44ch, white 45ch); -webkit-background-clip: text">            forwardPropParts.[layerIndex + 1]</span>
<span style="background: linear-gradient(to right , white 0ch, white 12ch, #f92672 12ch, #f92672 14ch, white 14ch, white 15ch, #fd971f 15ch, #fd971f 19ch, white 19ch, white 79ch); -webkit-background-clip: text">            |&gt; List.map2 (dLossFunction loss targetOutputs.Length) backPropPart</span>
<span style="background: linear-gradient(to right , white 0ch, white 8ch, #E68 8ch, #E68 12ch, white 12ch, white 13ch, lightgrey 13ch, lightgrey 29ch); -webkit-background-clip: text">        else // Hidden layers</span>
<span style="background: linear-gradient(to right , white 0ch, white 12ch, #fd971f 12ch, #fd971f 16ch, white 16ch, white 53ch, #A7C 53ch, #A7C 54ch, white 54ch, white 64ch, #78dce8 64ch, #78dce8 67ch, white 67ch, white 70ch, #f92672 70ch, #f92672 72ch); -webkit-background-clip: text">            List.init forwardPropParts.[layerIndex + 1].Length (fun _ -&gt;</span>
<span style="background: linear-gradient(to right , white 0ch, white 45ch); -webkit-background-clip: text">                forwardPropParts.[layerIndex]</span>
<span style="background: linear-gradient(to right , white 0ch, white 16ch, #f92672 16ch, #f92672 18ch, white 18ch, white 55ch, #A7C 55ch, #A7C 56ch, white 56ch, white 68ch); -webkit-background-clip: text">                |&gt; dActivateLayer layers.[layerIndex - 1].activation</span>
<span style="background: linear-gradient(to right , white 0ch, white 16ch, #f92672 16ch, #f92672 18ch, white 18ch, white 19ch, #fd971f 19ch, #fd971f 23ch, white 23ch, white 46ch); -webkit-background-clip: text">                |&gt; List.map2 (*) backPropPart)</span>
<span style="background: linear-gradient(to right , white 0ch, white 12ch, #f92672 12ch, #f92672 14ch, white 14ch, white 15ch, #fd971f 15ch, #fd971f 19ch, white 19ch, white 26ch, #78dce8 26ch, #78dce8 29ch, white 29ch, white 44ch, #f92672 44ch, #f92672 46ch); -webkit-background-clip: text">            |&gt; List.mapi (fun index1 deltas -&gt;</span>
<span style="background: linear-gradient(to right , white 0ch, white 39ch); -webkit-background-clip: text">                allWeights.[layerIndex]</span>
<span style="background: linear-gradient(to right , white 0ch, white 16ch, #f92672 16ch, #f92672 18ch, white 18ch, white 19ch, #fd971f 19ch, #fd971f 23ch, white 23ch, white 30ch, #78dce8 30ch, #78dce8 33ch, white 33ch, white 49ch, #f92672 49ch, #f92672 51ch, white 51ch, white 88ch); -webkit-background-clip: text">                |&gt; List.mapi (fun index2 weights -&gt; weights.[index1] * deltas.[index2]))</span>
<span style="background: linear-gradient(to right , white 0ch, white 12ch, #f92672 12ch, #f92672 14ch, white 14ch, white 15ch, #fd971f 15ch, #fd971f 19ch, white 19ch, white 24ch, #fd971f 24ch, #fd971f 28ch, white 28ch, white 32ch); -webkit-background-clip: text">            |&gt; List.map List.sum</span>
<span style="background: linear-gradient(to right ); -webkit-background-clip: text"></span>
<span style="background: linear-gradient(to right , white 0ch, white 4ch, #E68 4ch, #E68 7ch, white 7ch, white 20ch); -webkit-background-clip: text">    let newWeights =</span>
<span style="background: linear-gradient(to right , white 0ch, white 39ch, #A7C 39ch, #A7C 40ch, white 40ch, white 41ch); -webkit-background-clip: text">        forwardPropParts.[layerIndex + 1]</span>
<span style="background: linear-gradient(to right , white 0ch, white 8ch, #f92672 8ch, #f92672 10ch, white 10ch, white 56ch); -webkit-background-clip: text">        |&gt; dActivateLayer layers.[layerIndex].activation</span>
<span style="background: linear-gradient(to right , white 0ch, white 8ch, #f92672 8ch, #f92672 10ch, white 10ch, white 11ch, #fd971f 11ch, #fd971f 15ch, white 15ch, white 51ch); -webkit-background-clip: text">        |&gt; List.map2 (*) intermediateOutputDeltaSum</span>
<span style="background: linear-gradient(to right , white 0ch, white 8ch, #f92672 8ch, #f92672 10ch, white 10ch, white 11ch, #fd971f 11ch, #fd971f 15ch, white 15ch, white 21ch, #78dce8 21ch, #78dce8 24ch, white 24ch, white 31ch, #f92672 31ch, #f92672 33ch); -webkit-background-clip: text">        |&gt; List.map (fun delta -&gt;</span>
<span style="background: linear-gradient(to right , white 0ch, white 43ch, #A7C 43ch, #A7C 44ch, white 44ch, white 45ch); -webkit-background-clip: text">            forwardPropParts.[layerIndex + 2]</span>
<span style="background: linear-gradient(to right , white 0ch, white 12ch, #f92672 12ch, #f92672 14ch, white 14ch, white 15ch, #fd971f 15ch, #fd971f 19ch, white 19ch, white 25ch, #78dce8 25ch, #78dce8 28ch, white 28ch, white 33ch, #f92672 33ch, #f92672 35ch, white 35ch, white 64ch); -webkit-background-clip: text">            |&gt; List.map (fun out -&gt; learningRate * delta * out))</span>
<span style="background: linear-gradient(to right , white 0ch, white 8ch, #f92672 8ch, #f92672 10ch, white 10ch, white 11ch, #fd971f 11ch, #fd971f 15ch, white 15ch, white 22ch, #fd971f 22ch, #fd971f 26ch, white 26ch, white 62ch, #A7C 62ch, #A7C 63ch, white 63ch, white 64ch); -webkit-background-clip: text">        |&gt; List.map2 (List.map2 (-)) allWeights.[layerIndex + 1]</span>
<span style="background: linear-gradient(to right ); -webkit-background-clip: text"></span>
<span style="background: linear-gradient(to right , white 0ch, white 42ch); -webkit-background-clip: text">    newWeights, intermediateOutputDeltaSum</span></code></pre><p>The full back propagation involved first reversing the parameters. This makes it easier to work on as we start from the final layer and work towards the input.</p><p>The next step is to fold through the network from the outer layer and calculate all the new values for each weight using <code>backPropSingleLayer</code>. This is then added to a list containing each layer and acts as the accumulator.</p><pre class="fsharp"><code><span style="background: linear-gradient(to right , #E68 0ch, #E68 3ch, white 3ch, white 26ch, #a6e22e 26ch, #a6e22e 37ch, white 37ch, white 52ch, #a6e22e 52ch, #a6e22e 63ch, white 63ch, white 81ch, #a6e22e 81ch, #a6e22e 97ch, white 97ch, white 114ch, #a6e22e 114ch, #a6e22e 120ch, white 120ch, white 129ch, #a6e22e 129ch, #a6e22e 134ch, white 134ch, white 155ch, #a6e22e 155ch, #a6e22e 171ch, white 171ch, white 174ch, #a6e22e 174ch, #a6e22e 211ch, white 211ch, white 212ch); -webkit-background-clip: text">let backPropFull (layers : Layer list) (parameters : Parameters) (targetOutputs : float list list) (learningRate : float) (loss : Loss) (forwardPropParts : float list list) : (float list list * float list) list =</span>
<span style="background: linear-gradient(to right ); -webkit-background-clip: text"></span>
<span style="background: linear-gradient(to right , white 0ch, white 4ch, #E68 4ch, #E68 7ch, white 7ch, white 17ch); -webkit-background-clip: text">    let weights =</span>
<span style="background: linear-gradient(to right , white 0ch, white 8ch, #fd971f 8ch, #fd971f 12ch, white 12ch, white 35ch); -webkit-background-clip: text">        List.rev parameters.weights</span>
<span style="background: linear-gradient(to right ); -webkit-background-clip: text"></span>
<span style="background: linear-gradient(to right , white 0ch, white 4ch, #fd971f 4ch, #fd971f 8ch, white 8ch, white 32ch); -webkit-background-clip: text">    List.init (layers.Length) id</span>
<span style="background: linear-gradient(to right , white 0ch, white 4ch, #f92672 4ch, #f92672 6ch, white 6ch, white 7ch, #fd971f 7ch, #fd971f 11ch, white 11ch, white 18ch, #78dce8 18ch, #78dce8 21ch, white 21ch, white 32ch, #f92672 32ch, #f92672 34ch); -webkit-background-clip: text">    |&gt; List.fold (fun acc index -&gt;</span>
<span style="background: linear-gradient(to right , white 0ch, white 8ch, #E68 8ch, #E68 11ch, white 11ch, white 27ch); -webkit-background-clip: text">        let targetOutputs =</span>
<span style="background: linear-gradient(to right , white 0ch, white 17ch, #A7C 17ch, #A7C 18ch, white 18ch, white 19ch); -webkit-background-clip: text">            acc.[0]</span>
<span style="background: linear-gradient(to right , white 0ch, white 12ch, #f92672 12ch, #f92672 14ch, white 14ch, white 18ch); -webkit-background-clip: text">            |&gt; fst</span>
<span style="background: linear-gradient(to right , white 0ch, white 12ch, #f92672 12ch, #f92672 14ch, white 14ch, white 15ch, #fd971f 15ch, #fd971f 19ch, white 19ch, white 24ch, #fd971f 24ch, #fd971f 28ch, white 28ch, white 32ch); -webkit-background-clip: text">            |&gt; List.map List.sum</span>
<span style="background: linear-gradient(to right ); -webkit-background-clip: text"></span>
<span style="background: linear-gradient(to right , white 0ch, white 8ch, #E68 8ch, #E68 11ch, white 11ch, white 36ch, #A7C 36ch, #A7C 37ch, white 37ch, white 38ch); -webkit-background-clip: text">        let backPropPart = snd acc.[0]</span>
<span style="background: linear-gradient(to right ); -webkit-background-clip: text"></span>
<span style="background: linear-gradient(to right , white 0ch, white 8ch, #E68 8ch, #E68 11ch, white 11ch, white 28ch); -webkit-background-clip: text">        let backPropOutput =</span>
<span style="background: linear-gradient(to right , white 0ch, white 114ch); -webkit-background-clip: text">            backPropSingleLayer targetOutputs loss learningRate backPropPart index forwardPropParts weights layers</span>
<span style="background: linear-gradient(to right ); -webkit-background-clip: text"></span>
<span style="background: linear-gradient(to right , white 0ch, white 25ch, #f92672 25ch, #f92672 26ch, white 26ch, white 31ch); -webkit-background-clip: text">        [backPropOutput] @ acc)</span>
<span style="background: linear-gradient(to right , white 0ch, white 29ch, #fd971f 29ch, #fd971f 33ch, white 33ch, white 56ch); -webkit-background-clip: text">            [targetOutputs, (List.concat targetOutputs)]</span></code></pre><p>The derivatives of the activations and loss functions are very similar to the normal counter parts. Parts of the <code>dActivateLayer</code> and <code>dLossFunction</code> can be seen below:</p><pre class="fsharp"><code><span style="background: linear-gradient(to right , #E68 0ch, #E68 3ch, white 3ch, white 32ch, #a6e22e 32ch, #a6e22e 43ch, white 43ch, white 53ch, #a6e22e 53ch, #a6e22e 64ch, white 64ch, white 67ch, #a6e22e 67ch, #a6e22e 79ch, white 79ch, white 80ch); -webkit-background-clip: text">let dActivateLayer (activation : Activation) (input : float list) : float list =</span>
<span style="background: linear-gradient(to right , white 0ch, white 4ch, #E68 4ch, #E68 9ch, white 9ch, white 21ch, #E68 21ch, #E68 25ch); -webkit-background-clip: text">    match activation with</span>
<span style="background: linear-gradient(to right , white 0ch, white 14ch, #f92672 14ch, #f92672 16ch); -webkit-background-clip: text">    | Sigmoid -&gt;</span>
<span style="background: linear-gradient(to right , white 0ch, white 8ch, #fd971f 8ch, #fd971f 12ch, white 12ch, white 18ch, #78dce8 18ch, #78dce8 21ch, white 21ch, white 24ch, #f92672 24ch, #f92672 26ch, white 26ch, white 32ch, #A7C 32ch, #A7C 35ch, white 35ch, white 47ch); -webkit-background-clip: text">        List.map (fun x -&gt; x * (1.0 - x)) input</span>
<span style="background: linear-gradient(to right , white 0ch, white 11ch, #f92672 11ch, #f92672 13ch); -webkit-background-clip: text">    | Relu -&gt;</span>
<span style="background: linear-gradient(to right , white 0ch, white 8ch, #fd971f 8ch, #fd971f 12ch, white 12ch, white 18ch, #78dce8 18ch, #78dce8 21ch, white 21ch, white 24ch, #f92672 24ch, #f92672 26ch, white 26ch, white 27ch, #E68 27ch, #E68 29ch, white 29ch, white 34ch, #A7C 34ch, #A7C 37ch, white 37ch, white 38ch, #E68 38ch, #E68 42ch, white 42ch, white 43ch, #A7C 43ch, #A7C 46ch, white 46ch, white 47ch, #E68 47ch, #E68 51ch, white 51ch, white 52ch, #A7C 52ch, #A7C 55ch, white 55ch, white 62ch); -webkit-background-clip: text">        List.map (fun x -&gt; if x &gt; 0.0 then 1.0 else 0.0) input</span>
<span style="background: linear-gradient(to right ); -webkit-background-clip: text"></span>
<span style="background: linear-gradient(to right , #E68 0ch, #E68 3ch, white 3ch, white 25ch, #a6e22e 25ch, #a6e22e 30ch, white 30ch, white 36ch, #a6e22e 36ch, #a6e22e 40ch, white 40ch, white 43ch, #a6e22e 43ch, #a6e22e 68ch, white 68ch, white 69ch); -webkit-background-clip: text">let dLossFunction (loss : Loss) (n : int) : float -&gt; float -&gt; float =</span>
<span style="background: linear-gradient(to right , white 0ch, white 4ch, #E68 4ch, #E68 9ch, white 9ch, white 15ch, #E68 15ch, #E68 19ch); -webkit-background-clip: text">    match loss with</span>
<span style="background: linear-gradient(to right , white 0ch, white 10ch, #f92672 10ch, #f92672 12ch); -webkit-background-clip: text">    | MSE -&gt;</span>
<span style="background: linear-gradient(to right , white 0ch, white 8ch, #78dce8 8ch, #78dce8 11ch, white 11ch, white 26ch, #f92672 26ch, #f92672 28ch); -webkit-background-clip: text">        fun actual target -&gt;</span>
<span style="background: linear-gradient(to right , white 0ch, white 13ch, #A7C 13ch, #A7C 16ch, white 16ch, white 22ch, #f92672 22ch, #f92672 24ch, white 24ch, white 56ch, #A7C 56ch, #A7C 59ch); -webkit-background-clip: text">            (2.0 / (n |&gt; float)) * (actual - target) * -1.0</span>
<span style="background: linear-gradient(to right , white 0ch, white 10ch, #f92672 10ch, #f92672 12ch); -webkit-background-clip: text">    | MAE -&gt;</span>
<span style="background: linear-gradient(to right , white 0ch, white 8ch, #78dce8 8ch, #78dce8 11ch, white 11ch, white 26ch, #f92672 26ch, #f92672 28ch); -webkit-background-clip: text">        fun target actual -&gt;</span>
<span style="background: linear-gradient(to right , white 0ch, white 12ch, #E68 12ch, #E68 14ch, white 14ch, white 31ch, #E68 31ch, #E68 35ch, white 35ch, white 36ch, #A7C 36ch, #A7C 39ch, white 39ch, white 40ch, #E68 40ch, #E68 44ch, white 44ch, white 46ch, #A7C 46ch, #A7C 49ch); -webkit-background-clip: text">            if actual &gt; target then 1.0 else -1.0</span></code></pre><h3>Training</h3><p>To train a neural network you repeatedly run forward and backwards propagation and then update the weights accordingly. We repeatedly try out different inputs to avoid the network learning a specific input.</p><p>Training the network in F# is a fairly simple recursive function that continually picks a random sample of the data set and carries out forwards and backwards propagation using the sample for any number of iterations. A simplified version of the function (initialisation and printing etc. removed) can be seen below:</p><pre class="fsharp"><code><span style="background: linear-gradient(to right , #E68 0ch, #E68 3ch, white 3ch, white 4ch, #78dce8 4ch, #78dce8 7ch, white 7ch, white 27ch, #a6e22e 27ch, #a6e22e 38ch, white 38ch, white 48ch, #a6e22e 48ch, #a6e22e 59ch, white 59ch, white 77ch, #a6e22e 77ch, #a6e22e 81ch, white 81ch, white 96ch, #a6e22e 96ch, #a6e22e 102ch, white 102ch, white 103ch); -webkit-background-clip: text">let rec train (parameters : Parameters) (model : Layer list) (maxIterations : int) (iterations : int) =</span>
<span style="background: linear-gradient(to right , white 0ch, white 4ch, #E68 4ch, #E68 7ch, white 7ch, white 35ch, #A7C 35ch, #A7C 36ch, white 36ch, white 38ch, #fd971f 38ch, #fd971f 42ch, white 42ch, white 64ch); -webkit-background-clip: text">    let idx = System.Random().Next(0, List.length targetOutputs)</span>
<span style="background: linear-gradient(to right ); -webkit-background-clip: text"></span>
<span style="background: linear-gradient(to right , white 0ch, white 4ch, #E68 4ch, #E68 7ch, white 7ch, white 20ch); -webkit-background-clip: text">    let fullSingle =</span>
<span style="background: linear-gradient(to right , white 0ch, white 56ch); -webkit-background-clip: text">        forwardFull parameters inputs.[idx] architecture</span>
<span style="background: linear-gradient(to right , white 0ch, white 8ch, #f92672 8ch, #f92672 10ch, white 10ch, white 79ch); -webkit-background-clip: text">        |&gt; backPropFull architecture parameters targets.[idx] learningRate loss</span>
<span style="background: linear-gradient(to right , white 0ch, white 8ch, #f92672 8ch, #f92672 10ch, white 10ch, white 34ch); -webkit-background-clip: text">        |&gt; weightUpdate parameters</span>
<span style="background: linear-gradient(to right ); -webkit-background-clip: text"></span>
<span style="background: linear-gradient(to right , white 0ch, white 55ch, #A7C 55ch, #A7C 56ch, white 56ch, white 57ch); -webkit-background-clip: text">    train fullSingle model maxIterations (iterations + 1)</span>
<span style="background: linear-gradient(to right ); -webkit-background-clip: text"></span>
<span style="background: linear-gradient(to right , lightgrey 0ch, lightgrey 28ch); -webkit-background-clip: text">// This is called like below</span>
<span style="background: linear-gradient(to right , white 0ch, white 38ch, #A7C 38ch, #A7C 39ch); -webkit-background-clip: text">train initial architecture iterations 0</span></code></pre><h2>Using the library</h2><h3>Defining a network</h3><p>Networks can be specified using the following format. Any number of layers are supported. Provided they align, the dimensions can be as large as desired.</p><pre class="fsharp"><code><span style="background: linear-gradient(to right , #E68 0ch, #E68 3ch, white 3ch, white 15ch); -webkit-background-clip: text">let network = [</span>
<span style="background: linear-gradient(to right , white 0ch, white 17ch, #A7C 17ch, #A7C 18ch, white 18ch, white 33ch, #A7C 33ch, #A7C 34ch, white 34ch, white 58ch); -webkit-background-clip: text">    {inputDims = 3; outputDims = 5; activation = Sigmoid};</span>
<span style="background: linear-gradient(to right , white 0ch, white 17ch, #A7C 17ch, #A7C 18ch, white 18ch, white 33ch, #A7C 33ch, #A7C 34ch, white 34ch, white 58ch); -webkit-background-clip: text">    {inputDims = 5; outputDims = 6; activation = Sigmoid};</span>
<span style="background: linear-gradient(to right , white 0ch, white 17ch, #A7C 17ch, #A7C 18ch, white 18ch, white 33ch, #A7C 33ch, #A7C 34ch, white 34ch, white 58ch); -webkit-background-clip: text">    {inputDims = 6; outputDims = 2; activation = Sigmoid};</span>
<span style="background: linear-gradient(to right , white 0ch, white 1ch); -webkit-background-clip: text">]</span></code></pre><p>You can choose from multiple different activation functions including:</p><ul><li>Relu</li><li>Sigmoid</li><li>Tanh</li><li>Softmax</li><li>Leaky Relu</li><li>Elu</li><li>Selu</li><li>Softsign</li><li>Softplus</li><li>Exponential</li><li>Hard Sigmoid</li><li>Linear</li></ul><h3>Training a network</h3><p>Input data is provided in the form of a list of inputs, and a list of labels corresponding to each input.</p><pre class="fsharp"><code><span style="background: linear-gradient(to right , lightgrey 0ch, lightgrey 9ch); -webkit-background-clip: text">// Inputs</span>
<span style="background: linear-gradient(to right , #E68 0ch, #E68 3ch, white 3ch, white 12ch); -webkit-background-clip: text">let data = [</span>
<span style="background: linear-gradient(to right , white 0ch, white 5ch, #A7C 5ch, #A7C 8ch, white 8ch, white 10ch, #A7C 10ch, #A7C 13ch, white 13ch, white 15ch, #A7C 15ch, #A7C 18ch, white 18ch, white 20ch); -webkit-background-clip: text">    [0.5; 1.0; 0.2];</span>
<span style="background: linear-gradient(to right , white 0ch, white 5ch, #A7C 5ch, #A7C 8ch, white 8ch, white 10ch, #A7C 10ch, #A7C 13ch, white 13ch, white 15ch, #A7C 15ch, #A7C 18ch, white 18ch, white 20ch); -webkit-background-clip: text">    [0.1; 0.7; 1.0];</span>
<span style="background: linear-gradient(to right , white 0ch, white 5ch, #A7C 5ch, #A7C 8ch, white 8ch, white 10ch, #A7C 10ch, #A7C 13ch, white 13ch, white 15ch, #A7C 15ch, #A7C 18ch, white 18ch, white 20ch); -webkit-background-clip: text">    [1.0; 0.1; 0.1];</span>
<span style="background: linear-gradient(to right , white 0ch, white 5ch, #A7C 5ch, #A7C 8ch, white 8ch, white 10ch, #A7C 10ch, #A7C 14ch, white 14ch, white 16ch, #A7C 16ch, #A7C 19ch, white 19ch, white 21ch); -webkit-background-clip: text">    [0.0; 0.34; 0.8];</span>
<span style="background: linear-gradient(to right , white 0ch, white 5ch, #A7C 5ch, #A7C 8ch, white 8ch, white 10ch, #A7C 10ch, #A7C 13ch, white 13ch, white 15ch, #A7C 15ch, #A7C 18ch, white 18ch, white 19ch); -webkit-background-clip: text">    [0.6; 0.1; 0.3]</span>
<span style="background: linear-gradient(to right , white 0ch, white 1ch); -webkit-background-clip: text">]</span>
<span style="background: linear-gradient(to right ); -webkit-background-clip: text"></span>
<span style="background: linear-gradient(to right , lightgrey 0ch, lightgrey 9ch); -webkit-background-clip: text">// Labels</span>
<span style="background: linear-gradient(to right , #E68 0ch, #E68 3ch, white 3ch, white 14ch); -webkit-background-clip: text">let labels = [</span>
<span style="background: linear-gradient(to right , white 0ch, white 5ch, #A7C 5ch, #A7C 8ch, white 8ch, white 10ch, #A7C 10ch, #A7C 13ch, white 13ch, white 15ch); -webkit-background-clip: text">    [1.0; 1.0];</span>
<span style="background: linear-gradient(to right , white 0ch, white 5ch, #A7C 5ch, #A7C 8ch, white 8ch, white 10ch, #A7C 10ch, #A7C 13ch, white 13ch, white 15ch); -webkit-background-clip: text">    [0.0; 1.0];</span>
<span style="background: linear-gradient(to right , white 0ch, white 5ch, #A7C 5ch, #A7C 8ch, white 8ch, white 10ch, #A7C 10ch, #A7C 13ch, white 13ch, white 15ch); -webkit-background-clip: text">    [0.0; 0.0];</span>
<span style="background: linear-gradient(to right , white 0ch, white 5ch, #A7C 5ch, #A7C 8ch, white 8ch, white 10ch, #A7C 10ch, #A7C 13ch, white 13ch, white 15ch); -webkit-background-clip: text">    [1.0; 0.0];</span>
<span style="background: linear-gradient(to right , white 0ch, white 5ch, #A7C 5ch, #A7C 8ch, white 8ch, white 10ch, #A7C 10ch, #A7C 13ch, white 13ch, white 15ch); -webkit-background-clip: text">    [0.0; 1.0];</span>
<span style="background: linear-gradient(to right , white 0ch, white 1ch); -webkit-background-clip: text">]</span></code></pre><p>To train and run the network, see the code snippets below:</p><pre class="fsharp"><code><span style="background: linear-gradient(to right , lightgrey 0ch, lightgrey 70ch); -webkit-background-clip: text">// trainNetwork architecture labels data learning-rate loss iterations</span>
<span style="background: linear-gradient(to right , #E68 0ch, #E68 3ch, white 3ch, white 45ch, #A7C 45ch, #A7C 49ch, white 49ch, white 54ch, #A7C 54ch, #A7C 60ch); -webkit-background-clip: text">let model = trainNetwork network labels data 0.05 MSE 100000</span></code></pre><p>Currently, the following loss functions are avaliable:</p><ul><li>Mean Square Error</li><li>Cross Entropy</li><li>Mean Absolute Error</li></ul><h3>Running a trained network</h3><p>A single run of the network can be specified as follows:</p><pre class="fsharp"><code><span style="background: linear-gradient(to right , lightgrey 0ch, lightgrey 38ch); -webkit-background-clip: text">// runNetwork model input architecture</span>
<span style="background: linear-gradient(to right , white 0ch, white 18ch, #A7C 18ch, #A7C 21ch, white 21ch, white 23ch, #A7C 23ch, #A7C 26ch, white 26ch, white 28ch, #A7C 28ch, #A7C 31ch, white 31ch, white 41ch, lightgrey 41ch, lightgrey 68ch); -webkit-background-clip: text">runNetwork model [0.1; 0.8; 0.4] network // [0.90643753; 0.99834754]</span></code></pre><p>We can test multiple inputs by using a loop:</p><pre class="fsharp"><code><span style="background: linear-gradient(to right , #E68 0ch, #E68 3ch, white 3ch, white 8ch, #E68 8ch, #E68 10ch, white 10ch, white 11ch, #fd971f 11ch, #fd971f 15ch, white 15ch, white 22ch, #fd971f 22ch, #fd971f 26ch, white 26ch, white 43ch, #E68 43ch, #E68 45ch); -webkit-background-clip: text">for idx in List.init (List.length data) id do</span>
<span style="background: linear-gradient(to right , white 0ch, white 4ch, #fd971f 4ch, #fd971f 11ch, white 11ch, white 12ch, #FFD658 12ch, #FFD658 23ch, white 23ch, white 34ch); -webkit-background-clip: text">    printfn &quot;Input: %A&quot; data.[idx]</span>
<span style="background: linear-gradient(to right , white 0ch, white 4ch, #fd971f 4ch, #fd971f 11ch, white 11ch, white 12ch, #FFD658 12ch, #FFD658 24ch, white 24ch, white 62ch); -webkit-background-clip: text">    printfn &quot;Output: %A&quot; (runNetwork model data.[idx] network)</span></code></pre><p>This will print the following:</p><pre><code>Input: [0.5; 1.0; 0.2]
Output: [0.9748251802; 0.9991071572]

Input: [0.1; 0.7; 1.0]
Output: [0.04458155893; 0.9556900964]

Input: [1.0; 0.1; 0.1]
Output: [1.150921027e-05; 0.03353754142]

Input: [0.0; 0.34; 0.8]
Output: [0.9681691113; 0.03517992806]

Input: [0.6; 0.1; 0.3]
Output: [0.003145187104; 0.9791424116]
</code></pre><p>These match up with the labels specified earlier.</p><h2>Bugs</h2><p>Be careful with the chosen parameters. The networks can die easily if the chosen parameters cause weigths to overflow and become NaN, alternatively the network won’t learn the data set correctly.</p><h2>Acknowledgements</h2><p>A lot of inspiration comes from <a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/">this excellent blog post on backpropagation</a>.</p><h2>GitHub</h2><p>The full project can be viewed on <a href="https://github.com/joshjennings98/fsharp-neural-network">GitHub</a>.</p><footer><nav><a href="#fsharp-neural-network">Back to top</a></nav></footer></article><article class="page" id="website"><h2>This Website</h2><p>The goal of this website was to create an interactive static website using on HTML and CSS, no JavaScript. I had recently read <a href="https://briankoberlein.com/tech/quiet-web/">an article about the quiet web</a> which inspired me to try and create an interesting website that satisfied the requirements laid out in the blog post:</p><ul><li>Exclude any page that has ads.</li><li>Remove them if they use Google Analytics or Google Fonts.</li><li>Remove them if they use scripts or trackers.</li></ul><p>These are arbitrary requirements but it seemed like an interesting challenge. On top of this, in the event that CSS was disabled, I also wanted my website to retain most of it's usability.</p><p>I am not one for frontend development and none of the previous versions of my site have used a JavaScript framework, however, in a previous iteration of my website I had a script that would allow you to change the theme between light mode and dark mode. I enjoyed this gimicky feature and wanted to keep that functionality.</p><h2>Re-implementing theme toggle using only CSS</h2><p>The main feature that I wanted to emulate using CSS was a theme toggle. I wanted to be able to click a button and have the theme change in case a user doesn't like the default one. With JavaScript I would watch for a checkbox and have an <code>onchange</code> event that makes the colour changes. Since this relies on JavaScript, this approach is not possible. So using only CSS we need some way to:</p><ul><li>Know that a checkbox has been checked.</li><li>If the user previously had the theme activated then it should deactivate or vice versa.</li><li>This needs to be dynamic and not just occur on page load but any time a user checks the checkbox.</li><li>Ideally it accounts for the user's light/dark mode preferences.</li></ul><p>Luckily, CSS has <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/Pseudo-classes">pseudo-classes</a>. These are keywords that are attached to a selector and specify a state of the selected element, for example <code>:hover</code> is triggered when an element is hovered over. There exists the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/:checked"><code>:checked</code> pseudo-class</a> which can be used to change the style of a checkbox or radio button based on whether or not it is checked. This satisfies the goal of making the change dynamic and controllable by the user.</p><p>However, there is a problem. CSS stands for Cascading Style Sheets. Styling in CSS will only apply to descendants of the the DOM node for the element (if the styling doesn't only affect the specific element i.e. <code>margin</code> will only affect the current element, but <code>font-family</code> will apply to the descendants). In either case, the inheritance only goes down the DOM tree and we cannot affect the properties of any parent elements.</p><p>We can have some degree of control over which descendants are affected by the styling through the use of the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/General_sibling_combinator">general sibling combinator</a>. This seperates two seletors and matches all instances of the second element that appear anywhere after the first element that share the same parent element. For example, the following would match all span elements that come after the paragraph element in the DOM tree:</p><pre class="css"><code><span style="background: linear-gradient(to right , #66d9ef 0ch, #66d9ef 1ch, white 1ch, white 4ch, #66d9ef 4ch, #66d9ef 8ch, white 8ch, white 10ch); -webkit-background-clip: text">p ~ span {</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #a6e22e 2ch, #a6e22e 7ch, white 7ch, white 8ch, #ae81ff 8ch, #ae81ff 12ch, white 12ch, white 13ch); -webkit-background-clip: text">  color: red;</span>
<span style="background: linear-gradient(to right , white 0ch, white 1ch); -webkit-background-clip: text">}</span></code></pre><p>From the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/General_sibling_combinator#html">general sibling combinator docs</a> we can see how this would work:</p><pre class="html"><code><span style="background: linear-gradient(to right , #f92672 0ch, #f92672 9ch); -webkit-background-clip: text">&lt;article&gt;</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #f92672 2ch, #f92672 8ch, white 8ch, white 64ch, #f92672 64ch, #f92672 71ch); -webkit-background-clip: text">  &lt;span&gt;This is not red because it appears before any paragraph.&lt;/span&gt;</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #f92672 2ch, #f92672 5ch, white 5ch, white 25ch, #f92672 25ch, #f92672 29ch); -webkit-background-clip: text">  &lt;p&gt;Here is a paragraph.&lt;/p&gt;</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #f92672 2ch, #f92672 8ch, white 8ch, white 26ch, #f92672 26ch, #f92672 33ch); -webkit-background-clip: text">  &lt;code&gt;Here is some code.&lt;/code&gt;</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #f92672 2ch, #f92672 8ch); -webkit-background-clip: text">  &lt;span&gt;</span>
<span style="background: linear-gradient(to right , white 0ch, white 78ch); -webkit-background-clip: text">    This span is red because it appears after the paragraph, even though there</span>
<span style="background: linear-gradient(to right , white 0ch, white 30ch); -webkit-background-clip: text">    are other nodes in between</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #f92672 2ch, #f92672 9ch); -webkit-background-clip: text">  &lt;/span&gt;</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #f92672 2ch, #f92672 5ch, white 5ch, white 38ch, #f92672 38ch, #f92672 42ch); -webkit-background-clip: text">  &lt;p&gt;Whatever it may be, keep smiling.&lt;/p&gt;</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #f92672 2ch, #f92672 6ch, white 6ch, white 15ch, #f92672 15ch, #f92672 20ch); -webkit-background-clip: text">  &lt;h1&gt;Dream big&lt;/h1&gt;</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #f92672 2ch, #f92672 8ch); -webkit-background-clip: text">  &lt;span&gt;</span>
<span style="background: linear-gradient(to right , white 0ch, white 80ch); -webkit-background-clip: text">    Doesn't matter how many or what kind of nodes are in between, all spans from</span>
<span style="background: linear-gradient(to right , white 0ch, white 46ch); -webkit-background-clip: text">    the same parent after a paragraph are red.</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #f92672 2ch, #f92672 9ch); -webkit-background-clip: text">  &lt;/span&gt;</span>
<span style="background: linear-gradient(to right , #f92672 0ch, #f92672 10ch); -webkit-background-clip: text">&lt;/article&gt;</span>
<span style="background: linear-gradient(to right , #f92672 0ch, #f92672 6ch); -webkit-background-clip: text">&lt;span&gt;</span>
<span style="background: linear-gradient(to right , white 0ch, white 73ch); -webkit-background-clip: text">  This span is not red because it doesn't share a parent with a paragraph</span>
<span style="background: linear-gradient(to right , #f92672 0ch, #f92672 7ch); -webkit-background-clip: text">&lt;/span&gt;</span></code></pre><p>How does this help us? Well, since we can style elements based on the pseudo-class selectors, the CSS can be modified to change based on the checked state of a checkbox. Say we have a class for the checkbox called <code>.theme-checkbox</code>, we can do the following and change the font for siblings of an element based on whether the checkbox is checked:</p><pre class="css"><code><span style="background: linear-gradient(to right , #66d9ef 0ch, #66d9ef 8ch, white 8ch, white 10ch); -webkit-background-clip: text">.content {</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #a6e22e 2ch, #a6e22e 13ch, white 13ch, white 14ch, #ae81ff 14ch, #ae81ff 20ch, white 20ch, white 21ch); -webkit-background-clip: text">  font-family: Serif;</span>
<span style="background: linear-gradient(to right , white 0ch, white 1ch); -webkit-background-clip: text">}</span>
<span style="background: linear-gradient(to right ); -webkit-background-clip: text"></span>
<span style="background: linear-gradient(to right , white 0ch, white 1ch, #a6e22e 1ch, #a6e22e 15ch, #fd971f 15ch, #fd971f 24ch, white 24ch, white 26ch, #66d9ef 26ch, #66d9ef 36ch, white 36ch, white 38ch); -webkit-background-clip: text">.theme-checkbox:checked ~ .container {</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #a6e22e 2ch, #a6e22e 13ch, white 13ch, white 14ch, #ae81ff 14ch, #ae81ff 24ch, white 24ch, white 25ch); -webkit-background-clip: text">  font-family: Monospace;</span>
<span style="background: linear-gradient(to right , white 0ch, white 1ch); -webkit-background-clip: text">}</span></code></pre><p>And in the HTML do something like this:</p><pre class="html"><code><span style="background: linear-gradient(to right , #f92672 0ch, #f92672 7ch, white 7ch, white 14ch, #66d9ef 14ch, #66d9ef 19ch, white 19ch, white 20ch, #ae81ff 20ch, #ae81ff 36ch, white 36ch, white 37ch, #66d9ef 37ch, #66d9ef 39ch, white 39ch, white 40ch, #ae81ff 40ch, #ae81ff 47ch, white 47ch, white 48ch, #66d9ef 48ch, #66d9ef 52ch, white 52ch, white 53ch, #ae81ff 53ch, #ae81ff 63ch, #f92672 63ch, #f92672 64ch); -webkit-background-clip: text">&lt;input hidden class=&quot;theme-checkbox&quot; id=&quot;theme&quot; type=&quot;checkbox&quot;&gt;</span>
<span style="background: linear-gradient(to right ); -webkit-background-clip: text"></span>
<span style="background: linear-gradient(to right , #f92672 0ch, #f92672 5ch, #66d9ef 5ch, #66d9ef 10ch, white 10ch, white 11ch, #ae81ff 11ch, #ae81ff 22ch, #f92672 22ch, #f92672 23ch); -webkit-background-clip: text">&lt;div class=&quot;container&quot;&gt;</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #f92672 2ch, #f92672 9ch, #66d9ef 9ch, #66d9ef 14ch, white 14ch, white 15ch, #ae81ff 15ch, #ae81ff 28ch, white 28ch, white 29ch, #66d9ef 29ch, #66d9ef 32ch, white 32ch, white 33ch, #ae81ff 33ch, #ae81ff 40ch, #f92672 40ch, #f92672 41ch, white 41ch, white 53ch, #f92672 53ch, #f92672 61ch); -webkit-background-clip: text">  &lt;label class=&quot;theme-label&quot; for=&quot;theme&quot;&gt;Toggle Theme&lt;/label&gt;</span>
<span style="background: linear-gradient(to right , white 0ch, white 5ch); -webkit-background-clip: text">  ...</span>
<span style="background: linear-gradient(to right , #f92672 0ch, #f92672 6ch); -webkit-background-clip: text">&lt;/div&gt;</span></code></pre><p>You can see that the checkbox and the container are siblings. This is important as we wouldn't be able to have the content as a descendant of the checkbox due to the nature of inputs. One strange thing it does mean, is that we have the label for the button not be a parent or sibling of the checkbox. This is not an issue as we use the <code>for</code> attribute.</p><p>Now that we have the general technique, we can utilise it for theme toggle. In this example we are using it to toggle light and dark mode:</p><pre class="css"><code><span style="background: linear-gradient(to right , #fd971f 0ch, #fd971f 6ch, white 6ch, white 7ch); -webkit-background-clip: text">:root {</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #a6e22e 2ch, #a6e22e 10ch, white 10ch, white 11ch, #ae81ff 11ch, #ae81ff 19ch, white 19ch, white 20ch); -webkit-background-clip: text">  --c-text: #3c3836;</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #a6e22e 2ch, #a6e22e 16ch, white 16ch, white 17ch, #ae81ff 17ch, #ae81ff 25ch, white 25ch, white 26ch); -webkit-background-clip: text">  --c-background: #fbf1c7;</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #a6e22e 2ch, #a6e22e 15ch, white 15ch, white 16ch, #ae81ff 16ch, #ae81ff 24ch, white 24ch, white 25ch); -webkit-background-clip: text">  --c-dark-text: #ebdbb2;</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #a6e22e 2ch, #a6e22e 21ch, white 21ch, white 22ch, #ae81ff 22ch, #ae81ff 30ch, white 30ch, white 31ch); -webkit-background-clip: text">  --c-dark-background: #282828;</span>
<span style="background: linear-gradient(to right , white 0ch, white 1ch); -webkit-background-clip: text">}</span>
<span style="background: linear-gradient(to right ); -webkit-background-clip: text"></span>
<span style="background: linear-gradient(to right , #78dce8 0ch, #78dce8 7ch, white 7ch, white 8ch, #a6e22e 8ch, #a6e22e 28ch, white 28ch, white 29ch, #ae81ff 29ch, #ae81ff 35ch, white 35ch, white 37ch); -webkit-background-clip: text">@media (prefers-color-scheme: dark) {</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #fd971f 2ch, #fd971f 8ch, white 8ch, white 9ch); -webkit-background-clip: text">  :root {</span>
<span style="background: linear-gradient(to right , white 0ch, white 4ch, #a6e22e 4ch, #a6e22e 12ch, white 12ch, white 13ch, #ae81ff 13ch, #ae81ff 21ch, white 21ch, white 22ch); -webkit-background-clip: text">    --c-text: #ebdbb2;</span>
<span style="background: linear-gradient(to right , white 0ch, white 4ch, #a6e22e 4ch, #a6e22e 18ch, white 18ch, white 19ch, #ae81ff 19ch, #ae81ff 27ch, white 27ch, white 28ch); -webkit-background-clip: text">    --c-background: #282828;</span>
<span style="background: linear-gradient(to right , white 0ch, white 4ch, #a6e22e 4ch, #a6e22e 17ch, white 17ch, white 18ch, #ae81ff 18ch, #ae81ff 26ch, white 26ch, white 27ch); -webkit-background-clip: text">    --c-dark-text: #3c3836;</span>
<span style="background: linear-gradient(to right , white 0ch, white 4ch, #a6e22e 4ch, #a6e22e 23ch, white 23ch, white 24ch, #ae81ff 24ch, #ae81ff 32ch, white 32ch, white 33ch); -webkit-background-clip: text">    --c-dark-background: #fbf1c7;</span>
<span style="background: linear-gradient(to right , white 0ch, white 3ch); -webkit-background-clip: text">  }</span>
<span style="background: linear-gradient(to right , white 0ch, white 1ch); -webkit-background-clip: text">}</span>
<span style="background: linear-gradient(to right ); -webkit-background-clip: text"></span>
<span style="background: linear-gradient(to right , white 0ch, white 1ch, #a6e22e 1ch, #a6e22e 15ch, #fd971f 15ch, #fd971f 24ch, white 24ch, white 26ch, #66d9ef 26ch, #66d9ef 36ch, white 36ch, white 38ch); -webkit-background-clip: text">.theme-checkbox:checked ~ .container {</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #a6e22e 2ch, #a6e22e 10ch, white 10ch, white 11ch, #ae81ff 11ch, #ae81ff 30ch, white 30ch, white 31ch); -webkit-background-clip: text">  --c-text: var(--c-dark-text);</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #a6e22e 2ch, #a6e22e 16ch, white 16ch, white 17ch, #ae81ff 17ch, #ae81ff 42ch, white 42ch, white 43ch); -webkit-background-clip: text">  --c-background: var(--c-dark-background);</span>
<span style="background: linear-gradient(to right , white 0ch, white 1ch); -webkit-background-clip: text">}</span>
<span style="background: linear-gradient(to right ); -webkit-background-clip: text"></span>
<span style="background: linear-gradient(to right , #66d9ef 0ch, #66d9ef 10ch, white 10ch, white 12ch); -webkit-background-clip: text">.container {</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #a6e22e 2ch, #a6e22e 7ch, white 7ch, white 8ch, #ae81ff 8ch, #ae81ff 22ch, white 22ch, white 23ch); -webkit-background-clip: text">  color: var(--c-text);</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #a6e22e 2ch, #a6e22e 18ch, white 18ch, white 19ch, #ae81ff 19ch, #ae81ff 39ch, white 39ch, white 40ch); -webkit-background-clip: text">  background-color: var(--c-background);</span>
<span style="background: linear-gradient(to right , white 0ch, white 1ch); -webkit-background-clip: text">}</span></code></pre><p>We use <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/Using_CSS_custom_properties">CSS variables</a> and change them based on whether the checkbox is checked. We can then reference these variables in the CSS (such as when we set the background and text colour) to update the colours accordingly.</p><p>We also utilise <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/@media/prefers-color-scheme"><code>prefers-color-scheme</code></a> to detect whether the alternative colour scheme should be light or dark. There is this neat <a href="https://codepen.io/kleinfreund/pen/NmpKZM">codepen demo</a> for determining whether your web browser supports this and what defaults to. This all means that the website will have the correct colour scheme for users if they toggle the theme.</p><p>One more problem arises. In this case, the checkbox is not part of the content and so it is unaffected by the styling. We cannot make it part of the container because it will never be able to affect the styling of it's parent. Luckily, since the label that you can click doesn't have to be a sibling of the checkbox itself, we can just hide the actual checkbox. Since the label can be clicked and we used the <code>for</code> attribute, it should still be accessible.</p><h2>Storing theme across pages</h2><p>Now there is a theme I can toggle without JavaScript (yay), but if I go to another page on the website, the theme resets. This is because there is no state stored between pages. If I were using JavaScript then I could use <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage"><code>localStorage</code></a> to store a flag that lets the website know which theme should be used. You could do this with three lines of JavaScript. Unfortunately, I want to do it with zero lines of JavaScript which sadly isn't possible. There is no way to access the <code>localStorage</code> without JavaScript or JQuery (or maybe some fancy HTML5 or something). This is a limitation of CSS, there is literally no way to solve this. You cannot persist the theme information across pages.</p><p>Luckily there is a solution. Have the entire website in just one page, this way there is nothing to persist across pages because there are no pages. The website can act as if there are multiple pages whilst actually having only one page, this can be done using the power of CSS and radio buttons. In the previous section we went over the <code>:checked</code> psuedo-class for checkboxes. Another input type also has it's own <code>:checked</code> psuedo-class: radio buttons. Radio buttons allow you to select one option from a set of multiple options. You can select only one option at a time which means that we can use the radio button to control what page we are on. Then we can use the <code>:checked</code> pseudo-class to either show or hide sections on the website depending on the 'page' that has been chosen:</p><pre class="css"><code><span style="background: linear-gradient(to right , #66d9ef 0ch, #66d9ef 6ch, white 6ch, white 8ch, #66d9ef 8ch, #66d9ef 14ch, white 14ch, white 16ch, #66d9ef 16ch, #66d9ef 25ch, white 25ch, white 27ch); -webkit-background-clip: text">.page1, .page2, .homepage {</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #a6e22e 2ch, #a6e22e 9ch, white 9ch, white 10ch, #ae81ff 10ch, #ae81ff 15ch, white 15ch, white 16ch); -webkit-background-clip: text">  display: none;</span>
<span style="background: linear-gradient(to right , white 0ch, white 1ch); -webkit-background-clip: text">}</span>
<span style="background: linear-gradient(to right ); -webkit-background-clip: text"></span>
<span style="background: linear-gradient(to right , white 0ch, white 1ch, #a6e22e 1ch, #a6e22e 16ch, #fd971f 16ch, #fd971f 25ch, white 25ch, white 27ch, #66d9ef 27ch, #66d9ef 36ch, white 36ch, white 39ch, #a6e22e 39ch, #a6e22e 46ch, white 46ch, white 47ch, #ae81ff 47ch, #ae81ff 53ch, white 53ch, white 56ch); -webkit-background-clip: text">#homepage-button:checked ~ .homepage { display: block; }</span>
<span style="background: linear-gradient(to right , #66d9ef 0ch, #66d9ef 6ch, #a6e22e 6ch, #a6e22e 13ch, #fd971f 13ch, #fd971f 22ch, white 22ch, white 24ch, #66d9ef 24ch, #66d9ef 30ch, white 30ch, white 33ch, #a6e22e 33ch, #a6e22e 40ch, white 40ch, white 41ch, #ae81ff 41ch, #ae81ff 47ch, white 47ch, white 50ch); -webkit-background-clip: text">#page1-button:checked ~ .page1 { display: block; }</span>
<span style="background: linear-gradient(to right , #66d9ef 0ch, #66d9ef 6ch, #a6e22e 6ch, #a6e22e 13ch, #fd971f 13ch, #fd971f 22ch, white 22ch, white 24ch, #66d9ef 24ch, #66d9ef 30ch, white 30ch, white 33ch, #a6e22e 33ch, #a6e22e 40ch, white 40ch, white 41ch, #ae81ff 41ch, #ae81ff 47ch, white 47ch, white 50ch); -webkit-background-clip: text">#page2-button:checked ~ .page2 { display: block; }</span></code></pre><p>By default all the pages will be hidden, and then when a radio button is selected, it will override the default styling and set the display to <code>block</code> making the section visible. Since we will want the main page of the website to be visible, we can make the homepage radio button the value that is checked by default.</p><pre class="html"><code><span style="background: linear-gradient(to right , #f92672 0ch, #f92672 7ch, #66d9ef 7ch, #66d9ef 11ch, white 11ch, white 12ch, #ae81ff 12ch, #ae81ff 19ch, white 19ch, white 20ch, #66d9ef 20ch, #66d9ef 25ch, white 25ch, white 26ch, #ae81ff 26ch, #ae81ff 33ch, white 33ch, white 34ch, #66d9ef 34ch, #66d9ef 36ch, white 36ch, white 37ch, #ae81ff 37ch, #ae81ff 54ch, white 54ch, white 62ch, #f92672 62ch, #f92672 63ch); -webkit-background-clip: text">&lt;input type=&quot;radio&quot; class=&quot;radio&quot; id=&quot;homepage-button&quot; checked&gt;</span>
<span style="background: linear-gradient(to right , #f92672 0ch, #f92672 7ch, #66d9ef 7ch, #66d9ef 11ch, white 11ch, white 12ch, #ae81ff 12ch, #ae81ff 19ch, white 19ch, white 20ch, #66d9ef 20ch, #66d9ef 25ch, white 25ch, white 26ch, #ae81ff 26ch, #ae81ff 33ch, white 33ch, white 34ch, #66d9ef 34ch, #66d9ef 36ch, white 36ch, white 37ch, #ae81ff 37ch, #ae81ff 51ch, #f92672 51ch, #f92672 52ch); -webkit-background-clip: text">&lt;input type=&quot;radio&quot; class=&quot;radio&quot; id=&quot;page1-button&quot;&gt;</span>
<span style="background: linear-gradient(to right , #f92672 0ch, #f92672 7ch, #66d9ef 7ch, #66d9ef 11ch, white 11ch, white 12ch, #ae81ff 12ch, #ae81ff 19ch, white 19ch, white 20ch, #66d9ef 20ch, #66d9ef 25ch, white 25ch, white 26ch, #ae81ff 26ch, #ae81ff 33ch, white 33ch, white 34ch, #66d9ef 34ch, #66d9ef 36ch, white 36ch, white 37ch, #ae81ff 37ch, #ae81ff 51ch, #f92672 51ch, #f92672 52ch); -webkit-background-clip: text">&lt;input type=&quot;radio&quot; class=&quot;radio&quot; id=&quot;page2-button&quot;&gt;</span></code></pre><p>This is all good, except radio buttons don't look like page links. We want this webpage to look like a normal website, users should be able to interact with it like they would any other website and a set of radio buttons to switch pages looks a bit stupid. To solve this, we will use a similar technique that we used with the theme toggle, we will hide the radio buttons themselves and rely on the button labels. We can make the radio button labels by styling them so they have underlines and so that when a user hovers over them, the mouse pointer changes. This way a user will never know they aren't actual links and from an accessability standpoint we will make sure to have good labels. We can make links stay the same colour if they have been visited (I never liked them changing colour) and then the page switch buttons will be indistinguishable from normal links.</p><pre class="css"><code><span style="background: linear-gradient(to right , #66d9ef 0ch, #66d9ef 12ch, white 12ch, white 14ch); -webkit-background-clip: text">.page-button {</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #a6e22e 2ch, #a6e22e 8ch, white 8ch, white 9ch, #ae81ff 9ch, #ae81ff 17ch, white 17ch, white 18ch); -webkit-background-clip: text">  cursor: pointer;</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #a6e22e 2ch, #a6e22e 17ch, white 17ch, white 18ch, #ae81ff 18ch, #ae81ff 28ch, white 28ch, white 29ch); -webkit-background-clip: text">  text-decoration: underline;</span>
<span style="background: linear-gradient(to right , white 0ch, white 1ch); -webkit-background-clip: text">}</span>
<span style="background: linear-gradient(to right ); -webkit-background-clip: text"></span>
<span style="background: linear-gradient(to right , #66d9ef 0ch, #66d9ef 6ch, white 6ch, white 8ch, #66d9ef 8ch, #66d9ef 14ch, white 14ch, white 16ch, #66d9ef 16ch, #66d9ef 25ch, white 25ch, white 27ch); -webkit-background-clip: text">.page1, .page2, .homepage {</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #a6e22e 2ch, #a6e22e 9ch, white 9ch, white 10ch, #ae81ff 10ch, #ae81ff 15ch, white 15ch, white 16ch); -webkit-background-clip: text">  display: none;</span>
<span style="background: linear-gradient(to right , white 0ch, white 1ch); -webkit-background-clip: text">}</span>
<span style="background: linear-gradient(to right ); -webkit-background-clip: text"></span>
<span style="background: linear-gradient(to right , white 0ch, white 1ch, #a6e22e 1ch, #a6e22e 16ch, #fd971f 16ch, #fd971f 25ch, white 25ch, white 27ch, #66d9ef 27ch, #66d9ef 36ch, white 36ch, white 39ch, #a6e22e 39ch, #a6e22e 46ch, white 46ch, white 47ch, #ae81ff 47ch, #ae81ff 53ch, white 53ch, white 56ch); -webkit-background-clip: text">#homepage-button:checked ~ .homepage { display: block; }</span>
<span style="background: linear-gradient(to right , #66d9ef 0ch, #66d9ef 6ch, #a6e22e 6ch, #a6e22e 13ch, #fd971f 13ch, #fd971f 22ch, white 22ch, white 24ch, #66d9ef 24ch, #66d9ef 30ch, white 30ch, white 33ch, #a6e22e 33ch, #a6e22e 40ch, white 40ch, white 41ch, #ae81ff 41ch, #ae81ff 47ch, white 47ch, white 50ch); -webkit-background-clip: text">#page1-button:checked ~ .page1 { display: block; }</span>
<span style="background: linear-gradient(to right , #66d9ef 0ch, #66d9ef 6ch, #a6e22e 6ch, #a6e22e 13ch, #fd971f 13ch, #fd971f 22ch, white 22ch, white 24ch, #66d9ef 24ch, #66d9ef 30ch, white 30ch, white 33ch, #a6e22e 33ch, #a6e22e 40ch, white 40ch, white 41ch, #ae81ff 41ch, #ae81ff 47ch, white 47ch, white 50ch); -webkit-background-clip: text">#page2-button:checked ~ .page2 { display: block; }</span>
<span style="background: linear-gradient(to right ); -webkit-background-clip: text"></span>
<span style="background: linear-gradient(to right , #66d9ef 0ch, #66d9ef 1ch, white 1ch, white 3ch); -webkit-background-clip: text">a {</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #a6e22e 2ch, #a6e22e 7ch, white 7ch, white 8ch, #ae81ff 8ch, #ae81ff 22ch, white 22ch, white 23ch); -webkit-background-clip: text">  color: var(--c-text);</span>
<span style="background: linear-gradient(to right , white 0ch, white 1ch); -webkit-background-clip: text">}</span></code></pre><p>This is combined with the following HTML:</p><pre class="html"><code><span style="background: linear-gradient(to right , #f92672 0ch, #f92672 7ch, #66d9ef 7ch, #66d9ef 10ch, white 10ch, white 11ch, #ae81ff 11ch, #ae81ff 28ch, white 28ch, white 29ch, #66d9ef 29ch, #66d9ef 34ch, white 34ch, white 35ch, #ae81ff 35ch, #ae81ff 48ch, #f92672 48ch, #f92672 49ch, white 49ch, white 53ch, #f92672 53ch, #f92672 61ch); -webkit-background-clip: text">&lt;label for=&quot;homepage-button&quot; class=&quot;page-button&quot;&gt;Home&lt;/label&gt;</span>
<span style="background: linear-gradient(to right , #f92672 0ch, #f92672 7ch, #66d9ef 7ch, #66d9ef 10ch, white 10ch, white 11ch, #ae81ff 11ch, #ae81ff 25ch, white 25ch, white 26ch, #66d9ef 26ch, #66d9ef 31ch, white 31ch, white 32ch, #ae81ff 32ch, #ae81ff 45ch, #f92672 45ch, #f92672 46ch, white 46ch, white 52ch, #f92672 52ch, #f92672 60ch); -webkit-background-clip: text">&lt;label for=&quot;page1-button&quot; class=&quot;page-button&quot;&gt;Page 1&lt;/label&gt;</span>
<span style="background: linear-gradient(to right , #f92672 0ch, #f92672 7ch, #66d9ef 7ch, #66d9ef 10ch, white 10ch, white 11ch, #ae81ff 11ch, #ae81ff 25ch, white 25ch, white 26ch, #66d9ef 26ch, #66d9ef 31ch, white 31ch, white 32ch, #ae81ff 32ch, #ae81ff 45ch, #f92672 45ch, #f92672 46ch, white 46ch, white 52ch, #f92672 52ch, #f92672 60ch); -webkit-background-clip: text">&lt;label for=&quot;page2-button&quot; class=&quot;page-button&quot;&gt;Page 2&lt;/label&gt;</span>
<span style="background: linear-gradient(to right ); -webkit-background-clip: text"></span>
<span style="background: linear-gradient(to right , #f92672 0ch, #f92672 7ch, #66d9ef 7ch, #66d9ef 11ch, white 11ch, white 12ch, #ae81ff 12ch, #ae81ff 19ch, white 19ch, white 20ch, #66d9ef 20ch, #66d9ef 25ch, white 25ch, white 26ch, #ae81ff 26ch, #ae81ff 33ch, white 33ch, white 34ch, #66d9ef 34ch, #66d9ef 36ch, white 36ch, white 37ch, #ae81ff 37ch, #ae81ff 54ch, white 54ch, white 69ch, #f92672 69ch, #f92672 70ch); -webkit-background-clip: text">&lt;input type=&quot;radio&quot; class=&quot;radio&quot; id=&quot;homepage-button&quot; checked hidden&gt;</span>
<span style="background: linear-gradient(to right , #f92672 0ch, #f92672 7ch, #66d9ef 7ch, #66d9ef 11ch, white 11ch, white 12ch, #ae81ff 12ch, #ae81ff 19ch, white 19ch, white 20ch, #66d9ef 20ch, #66d9ef 25ch, white 25ch, white 26ch, #ae81ff 26ch, #ae81ff 33ch, white 33ch, white 34ch, #66d9ef 34ch, #66d9ef 36ch, white 36ch, white 37ch, #ae81ff 37ch, #ae81ff 51ch, white 51ch, white 58ch, #f92672 58ch, #f92672 59ch); -webkit-background-clip: text">&lt;input type=&quot;radio&quot; class=&quot;radio&quot; id=&quot;page1-button&quot; hidden&gt;</span>
<span style="background: linear-gradient(to right , #f92672 0ch, #f92672 7ch, #66d9ef 7ch, #66d9ef 11ch, white 11ch, white 12ch, #ae81ff 12ch, #ae81ff 19ch, white 19ch, white 20ch, #66d9ef 20ch, #66d9ef 25ch, white 25ch, white 26ch, #ae81ff 26ch, #ae81ff 33ch, white 33ch, white 34ch, #66d9ef 34ch, #66d9ef 36ch, white 36ch, white 37ch, #ae81ff 37ch, #ae81ff 51ch, white 51ch, white 58ch, #f92672 58ch, #f92672 59ch); -webkit-background-clip: text">&lt;input type=&quot;radio&quot; class=&quot;radio&quot; id=&quot;page2-button&quot; hidden&gt;</span></code></pre><p>A nice thing about having a single webpage and using the radio buttons is that the website is extremely responsive as there are no HTTP requests between page switches since we have all the 'pages' all the time. This could cause problems in the future if there were a lot of pages and the website became very large. However, this would only affect the initial page load and once loaded you would have a quick and snappy website. There are many websites outhere that have multi-megabyte pages as they load in all the image, scripts, and styles yet they remain responsive so I am confident this website would as well.</p><p>A problem with this is that if we add a page we need to make changes to the CSS to add the new rule for which page to show and hide. This can be solved by templating the CSS when generating the website or it will be solved as a side effect of what we do in the next section.</p><h2>Having usable URLs</h2><p>We almost have a fully functional website that behaves as if there are multiple pages whilst actually only having one page. Unfortunately, there is yet another issue. You can only choose the pages via the radio buttons, you can't go to a specific page via a URL. This means you cannot share a page, a problem if the site is used as a blog or a portfolio. This is because you cannot set radio buttons based on the contents of the URL (well as usual, you could do if you were willing to use JavaScript, but I am not). Without this feature the website is basically unusable, I want to be able to link to specific pages from other pages or even from other websites. Luckily, there is a solution!</p><p>This problem can be solved by replacing the radio buttons with links. But wait, then we won't be able to use the <code>:checked</code> pseudo-class. Yes, that is true, but luckily there is another pseudo-class we can use: the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/:target"><code>:target</code> pseudo-class</a>! This pseudo-class represents an element with an id matching the URL's <a href="https://en.wikipedia.org/wiki/URI_fragment">fragment</a>. This is a string of characters that refers to a resource that is subordinate to another resource. For URLs, the fragment is the last part of a URL preceded by the <code>#</code>. It is usually used for identifying a portion of a document so that you can jump to a particular heading. We choose this over the query of the URL so that the pseudo-class can be used. Some other examples of how the fragment can be used, such as a pure CSS light box or table of contents, can be found in <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/:target#examples">the Mozilla web docs</a>.</p><p>In our case we have behavior similar to the radio buttons. We will hide all pages and then depending on which id is targeted, we will unhide that page:</p><pre class="css"><code><span style="background: linear-gradient(to right , #66d9ef 0ch, #66d9ef 14ch, white 14ch, white 16ch); -webkit-background-clip: text">.homepage.page {</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #a6e22e 2ch, #a6e22e 9ch, white 9ch, white 10ch, #ae81ff 10ch, #ae81ff 16ch, white 16ch, white 18ch, lightgrey 18ch, lightgrey 60ch); -webkit-background-clip: text">  display: block; /* The homepage is displayed by default */</span>
<span style="background: linear-gradient(to right , white 0ch, white 1ch); -webkit-background-clip: text">}</span>
<span style="background: linear-gradient(to right ); -webkit-background-clip: text"></span>
<span style="background: linear-gradient(to right , #66d9ef 0ch, #66d9ef 5ch, white 5ch, white 7ch); -webkit-background-clip: text">.page {</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #a6e22e 2ch, #a6e22e 9ch, white 9ch, white 10ch, #ae81ff 10ch, #ae81ff 15ch, white 15ch, white 16ch); -webkit-background-clip: text">  display: none;</span>
<span style="background: linear-gradient(to right , white 0ch, white 1ch); -webkit-background-clip: text">}</span>
<span style="background: linear-gradient(to right ); -webkit-background-clip: text"></span>
<span style="background: linear-gradient(to right , white 0ch, white 1ch, #a6e22e 1ch, #a6e22e 5ch, #fd971f 5ch, #fd971f 13ch, white 13ch, white 14ch); -webkit-background-clip: text">.page:target {</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #a6e22e 2ch, #a6e22e 9ch, white 9ch, white 10ch, #ae81ff 10ch, #ae81ff 16ch, white 16ch, white 18ch, lightgrey 18ch, lightgrey 62ch); -webkit-background-clip: text">  display: block; /* When an id is targeted, show that page */</span>
<span style="background: linear-gradient(to right , white 0ch, white 1ch); -webkit-background-clip: text">}</span>
<span style="background: linear-gradient(to right ); -webkit-background-clip: text"></span>
<span style="background: linear-gradient(to right , white 0ch, white 1ch, #a6e22e 1ch, #a6e22e 5ch, #fd971f 5ch, #fd971f 13ch, white 13ch, white 15ch, #66d9ef 15ch, #66d9ef 29ch, white 29ch, white 31ch); -webkit-background-clip: text">.page:target ~ .homepage.page {</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #a6e22e 2ch, #a6e22e 9ch, white 9ch, white 10ch, #ae81ff 10ch, #ae81ff 15ch, white 15ch, white 17ch, lightgrey 17ch, lightgrey 64ch); -webkit-background-clip: text">  display: none; /* When an id is targeted, hide the homepage */</span>
<span style="background: linear-gradient(to right , white 0ch, white 1ch); -webkit-background-clip: text">}</span></code></pre><p>There is a difference vs the radio button version, that being that we have explicit behavior for the homepage. Since the default is that there is no fragment, we want to make sure that the homepage is shown if there is no fragment. We can't have a default fragment as that would make the URL messy. We therefore use the power of the General sibling combinator again to have the homepage show by default then hide if any other sibling page is selected. This means that the individual pages of the website can be accessed by doing <code>https://website.com#page</code>! Due to the nature of the combinators, we need to make sure that the homepage is the final section of the website since we want to hide it if a page is selected and we can only affect elements that come after the current DOM element.</p><p>To specify links to the pages within the website, we just have to create links to them like you would in a table of contents:</p><pre class="html"><code><span style="background: linear-gradient(to right , #f92672 0ch, #f92672 3ch, #66d9ef 3ch, #66d9ef 7ch, white 7ch, white 8ch, #ae81ff 8ch, #ae81ff 16ch, #f92672 16ch, #f92672 17ch, white 17ch, white 23ch, #f92672 23ch, #f92672 27ch); -webkit-background-clip: text">&lt;a href=&quot;#page1&quot;&gt;Page 1&lt;/a&gt;</span>
<span style="background: linear-gradient(to right , #f92672 0ch, #f92672 3ch, #66d9ef 3ch, #66d9ef 7ch, white 7ch, white 8ch, #ae81ff 8ch, #ae81ff 16ch, #f92672 16ch, #f92672 17ch, white 17ch, white 23ch, #f92672 23ch, #f92672 27ch); -webkit-background-clip: text">&lt;a href=&quot;#page2&quot;&gt;Page 2&lt;/a&gt;</span>
<span style="background: linear-gradient(to right ); -webkit-background-clip: text"></span>
<span style="background: linear-gradient(to right , #f92672 0ch, #f92672 5ch, #66d9ef 5ch, #66d9ef 10ch, white 10ch, white 11ch, #ae81ff 11ch, #ae81ff 17ch, white 17ch, white 18ch, #66d9ef 18ch, #66d9ef 20ch, white 20ch, white 21ch, #ae81ff 21ch, #ae81ff 28ch, #f92672 28ch, #f92672 30ch); -webkit-background-clip: text">&lt;div class=&quot;page&quot; id=&quot;page1&quot;/&gt;</span>
<span style="background: linear-gradient(to right , #f92672 0ch, #f92672 5ch, #66d9ef 5ch, #66d9ef 10ch, white 10ch, white 11ch, #ae81ff 11ch, #ae81ff 17ch, white 17ch, white 18ch, #66d9ef 18ch, #66d9ef 20ch, white 20ch, white 21ch, #ae81ff 21ch, #ae81ff 28ch, #f92672 28ch, #f92672 30ch); -webkit-background-clip: text">&lt;div class=&quot;page&quot; id=&quot;page2&quot;/&gt;</span></code></pre><p>An issue with this is that when you go to a heading via a fragment, it shifts the page downwards so that the heading is at the top of the page. This is fine if we were using the fragments with what they were designed for but it is a bit annoying as we want to be able to see the website header on each 'page'. To solve this we do a bit of a hacky solution, we add some invisible content before every element that gets targeted by a fragment, effectively pushing the actual content down the page by a fixed amount. it is a bit messy but it works.</p><pre class="css"><code><span style="background: linear-gradient(to right , white 0ch, white 1ch, #a6e22e 1ch, #a6e22e 7ch, white 7ch, white 8ch, #fd971f 8ch, #fd971f 16ch, white 16ch, white 17ch); -webkit-background-clip: text">:target::before {</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #a6e22e 2ch, #a6e22e 9ch, white 9ch, white 10ch, #ae81ff 10ch, #ae81ff 13ch, white 13ch, white 14ch); -webkit-background-clip: text">  content: &quot;&quot;;</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #a6e22e 2ch, #a6e22e 9ch, white 9ch, white 10ch, #ae81ff 10ch, #ae81ff 16ch, white 16ch, white 17ch); -webkit-background-clip: text">  display: block;</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #a6e22e 2ch, #a6e22e 8ch, white 8ch, white 9ch, #ae81ff 9ch, #ae81ff 16ch, white 16ch, white 18ch, lightgrey 18ch, lightgrey 43ch); -webkit-background-clip: text">  height: 1000px; /* Fixed header height */</span>
<span style="background: linear-gradient(to right , white 0ch, white 2ch, #a6e22e 2ch, #a6e22e 8ch, white 8ch, white 9ch, #ae81ff 9ch, #ae81ff 17ch, white 17ch, white 18ch, #66d9ef 18ch, #66d9ef 19ch, white 19ch, white 20ch, #66d9ef 20ch, #66d9ef 21ch, white 21ch, white 23ch, lightgrey 23ch, lightgrey 57ch); -webkit-background-clip: text">  margin: -1000px 0 0; /* Negative fixed header height */</span>
<span style="background: linear-gradient(to right , white 0ch, white 1ch); -webkit-background-clip: text">}</span></code></pre><p>And with that, we have a fully usable single-page website that behaves like it has multiple pages and has a theme toggle and uses no JavaScript. Obviously this is isn't viable for every website, but it was a fun idea to mess about with and the result is something I am quite happy with. It has all the features I want in a website without the bloat (although it uses slightly complex CSS that probably doesn't function on some browsers). Even if CSS is fully disabled, the website remains usable, it isn't as nice to use but is still completely functional. The fact it is just a single page of HTML and a bit of CSS means that it should be easily trasnsportable across web hosts with very little work when migrating. Now we just need a way to add content and deploy it!</p><h2>Code Generation</h2><p>The website exists as a series of markdown files which are converted into HTML. I use clojure (with <a href="https://babashka.org/">babashka</a>) to do this. The generated <code>index.html</code> is then hosted with <a href="https://pages.github.com/">GitHub pages</a>.</p><h3>Converting Markdown to HTML</h3><p>I used to use templates for generating my website content. This worked fine but it is hard to read so I wanted a component library that meant I could write the website components in Clojure itself. This also means that testing is easier as I can test individual components. I went with <a href="https://github.com/retrogradeorbit/bootleg">bootleg</a> as it is available as a <a href="https://github.com/babashka/pods">babashka pod</a> meaning I can use it's utilities from within Clojure code. The website boilerplate is written using <a href="https://github.com/weavejester/hiccup">hiccup</a> which represents HTML in Clojure using vectors. This means that everything is written in Clojure and there are no templates needed.</p><p>The code for the generators can be found in the <a href="https://github.com/joshjennings98/joshjennings98.github.io/blob/master/generate.clj"><code>generate.clj</code></a> in the <a href="https://github.com/joshjennings98/joshjennings98.github.io">GitHub repo</a> for this project.</p><h3>Syntax Highlighting with CSS gradients</h3><p>There are a lot of code snippets on my website and it would be nice if they could have some syntax highlighting. The most common way to do this is with a library like <a href="https://highlightjs.org/">highlight.js</a> where JavaScript is used to determine the language and automatically highlight the code. This requires JavaScript which means I don't want it on my website. The other way is to generate the css for each syntax element in a language and wrap each part of the code in a span that matches the syntax element. This works but you end up with a million spans and it is also a bit boring.</p><p>The much more interesting and fun approach is to use CSS gradients. Like almost every approach, we use regex (although I am sure some JavaScript libraries exist that use <a href="https://tree-sitter.github.io/tree-sitter/">treesitter</a> to do syntax highlighting (like my <a href="https://helix-editor.com/">favourite text editor</a> does)) to work out the styling for each element but instead of wrapping each element in a span, we style the whole pre with gradients. This avoids having a mess of spans and uses no javascript.</p><p>Lets say we have the following code block:</p><pre><code>for(i = 0; i &lt; 10; i++){
    console.log(i);
}
</code></pre><p>We utilise a horrible regex to match specific keywords etc. and create a gradient that lines up with the text:</p><p><pre style="padding: 0; background: linear-gradient(to right, white 0ch, #E68 0ch, #E68 3ch, white 3ch, white 8ch, #A7C 8ch, #A7C 9ch, white 9ch, white 13ch, #f92672 13ch, #f92672 14ch, white 14ch, white 15ch, #A7C 15ch, #A7C 17ch, white 17ch, white 20ch, #f92672 20ch, #f92672 22ch, white 22ch, white 300ch), linear-gradient(to right, white 0ch, white 0ch, white 4ch, #fd971f 4ch, #fd971f 11ch, white 11ch, white 12ch, #a6e22e 12ch, #a6e22e 15ch, white 15ch, white 300ch), linear-gradient(to right, white 0ch, white 0ch, white 300ch); background-repeat: no-repeat; background-size: 80ch 22px, 80ch 44px, 80ch 66px, 80ch 88px; color: black; width: 80ch; font-family: monospace; font-size: 20px; line-height: 22px; width:inherit">
for(i = 0; i &lt; 10; i++){
    console.log(i);
}
</pre></p><p>We then set this as the background for the <code>pre</code> and make the text transparent. This makes the colour of the text match the gradient.</p><p>I lied about not using spans. An unfortunate problem with the gradients is that depending on the browser, you can end up with the gradient from one line affecting the colours in the surrounding lines. You can also end up with some other rendering artifacts because browsers aren't designed carry out syntax highlighting with this method. Therefore we wrap each line in a span which avoids the rendering issues. Whilst there are some spans, this approach is still better than wrapping each syntax element in a span.</p><p>The end result can be seen below:</p><pre class="javascript"><code><span style="background: linear-gradient(to right , #E68 0ch, #E68 3ch, white 3ch, white 8ch, #A7C 8ch, #A7C 9ch, white 9ch, white 13ch, #f92672 13ch, #f92672 14ch, white 14ch, white 15ch, #A7C 15ch, #A7C 17ch, white 17ch, white 20ch, #f92672 20ch, #f92672 22ch, white 22ch, white 24ch); -webkit-background-clip: text">for(i = 0; i &lt; 10; i++){</span>
<span style="background: linear-gradient(to right , white 0ch, white 4ch, #fd971f 4ch, #fd971f 11ch, white 11ch, white 12ch, #a6e22e 12ch, #a6e22e 15ch, white 15ch, white 19ch); -webkit-background-clip: text">    console.log(i);</span>
<span style="background: linear-gradient(to right , white 0ch, white 1ch); -webkit-background-clip: text">}</span></code></pre><p>The resulting effect looks quite nice if you get the regular expressions for the language syntax correct (you might notice some places on this website where the choice of regex causes problems but this is just meant to be a bit of fun). It should be noted that this whole technique is quite pointless and it causes the website to take up more space than just using a JavaScript library for the highlighting.</p><h2>Deployment using GitHub Pages</h2><p>I don't want to spend money so I host the website with <a href="https://pages.github.com/">GitHub pages</a>. This is particularly nice since I am hosting the repository on GitHub so deployments are trivial, I just run the go code to generate the static files and I am done.</p><h2>Acknowledgements</h2><p>A lot of inspiration was taked from <a href="https://kleinfreund.de/css-only-dark-mode/">this blog post</a> on CSS-only dark mode for the initial work on reimplementing the theme toggle without JavaScript.</p><p>This <a href="https://codepen.io/finnhvman">person on codepen</a> has a lot of amazing CSS only stuff available that make this website seem like a toy. They also have some cool SVG stuff like this <a href="https://codepen.io/finnhvman/pen/jOQvYaz">gas giant</a> that I want to include on my website somehow.</p><p>The CSS only syntax highlighting is a slightly modified version of the work in <a href="https://dev.to/grahamthedev/impossible-css-only-js-syntax-highlighting-with-a-single-element-and-gradients-243j">this blog post</a>.</p><h2>Github</h2><p>The full project can be viewed on <a href="https://github.com/joshjennings98/joshjennings98.github.io">GitHub</a>.</p><footer><nav><a href="#website">Back to top</a></nav></footer></article><article class="page" id="backend-demos"><h2>Backend Demo Tool</h2><p>This is a small <a href="https://flask.palletsprojects.com/en/2.3.x/">Flask</a> application that makes it easier to demonstrate backend features.</p><p>Frontend developers have a much easier time of it when it comes to demonstrating their work. It is easy to see what they've done and they can make it look as interesting as they want. In comparison, trying to demo a backend API or tool is rarely interesting to watch. It usually involves a lot of text, ends up with the presenter pulling out a terminal to show commands on the fly, searching their command history and hoping they do everything in the right order. All this to get some JSON or similarly uninteresting output.</p><p>This project is an attempt to try and improve that situation and make backend demos simpler and more engaging. To do this, a python application was created that reads a simple text file containing information to present and generates a web server with Flask. The data for each slide is exposed as JSON via endpoints and with a simple <code>index.html</code> and some JavaScript, the tool is able to create a simple presentation that is shown in the browser and can be clicked through like a PowerPoint presentation.</p><p>The advantage this provides is that python can be to execute pre-written commands and stream the results back to the webserver and expose it via an iframe that is then embedded into a slide. This allows you to easily demonstrate commands without having to open a terminal. It also means you can plan the exact order of the commands and not worry about mixing them up. A side effect of running the presentation in the browser is that you can easily have links that open up in new tabs which can be useful to show the result of any executed commands, this is useful as you can just share the web browser during a meeting instead of having to switch between PowerPoint, a terminal, and a web browser.</p><p>This application lends itself to a presentation method similar to the <a href="https://en.wikipedia.org/wiki/Takahashi_method">Takahashi method</a> where you have a concise slides with very little text. The created presentations are more complex than the Taskahashi method but it is still purposefully designed to keep things simple by only having one type of content per slide, be that text, a command output, or something else.</p><p>The result is that with this application backend demos should be much easier to create and run whilst also being slightly more engaging.</p><h2>Features</h2><ul><li>A presentation is uses just a simple text file.</li><li>A slide can contain one of: text, an executed command, a code block, or an image and are delimted by the tags: <code>[TEXT]</code>, <code>[COMMAND]</code>, <code>[CODE]</code>, and <code>[IMAGE]</code>.</li><li>Executed commands will stream output to be shown in the slide.</li><li>The command that is executed is shown above the command output.</li><li>Correctly renders commands that span multiple lines.</li><li>Optionally run command every few seconds like <code>watch</code>.</li><li>Code blocks are automatically highlighted using <a href="https://highlightjs.org/">hightlight.js</a>.</li><li>Text slides will add text line by line like a PowerPoint presentation with animations.</li><li>Left click or right arrow to go forwards, right click or left arrow to go backwards.</li><li>When going backwards previously rendered text is handled properly and slides don't reset.</li><li>Extremely easy to use and share via screen sharing.</li><li>Configurable CSS if you desire to change the look.</li><li>Jump to any slide via a drop down menu.</li></ul><h2>Usage</h2><p>The tool is not on PyPi so to install it you will need to <a href="https://github.com/joshjennings98/backend-demo">clone the repository</a>. Once this is done <code>cd</code> into the base directory and run <code>pip install .</code> to install it as <code>backend_demo</code>.</p><p>To create a presentation you just need to write a command file <code>commands.txt</code> like this:</p><pre><code>[TEXT] 
This is a slide

[COMMAND] 
ping -c 4 google.com

[TEXT] 
I am another text slide
with multiple lines

[IMAGE]
https://upload.wikimedia.org/wikipedia/en/7/73/Hyperion_cover.jpg

[CODE]
def main():
    print(&quot;I am a code block&quot;)
    print(&quot;I will be automatically syntax highlighted with hightlight.js&quot;)

[COMMAND]
echo commands \
spanning \
multiple \
lines \
are \
handled
</code></pre><p>To present a presentation, pass the command file as an argument to <code>backend_demo</code>:</p><pre><code>backend_demo commands.txt
</code></pre><p><i>Currently, all the commands are run in a sub shell on you machine so be careful with what you execute.</i></p><h2>Github Repository</h2><p>The full project can be viewed on <a href="https://github.com/joshjennings98/backend-demo">GitHub</a>.</p><footer><nav><a href="#backend-demos">Back to top</a></nav></footer></article><article class="homepage page" id=""><h2>About Me</h2><p>My name is Josh Jennings and I'm a backend software engineer at Arm. I work in the Online Tools Group where I help develop and maintain the backend services that power the <a href="https://studio.keil.arm.com/">Keil Studio Cloud</a> online IDE for embedded developers and <a href="https://www.keil.arm.com">keil.arm.com</a>. My areas of expertise are in backend web development using Go and Python as well as the use of Kubernetes in orchestrating scalable cloud services.</p><ul><li>My GitHub is available <a href="https://github.com/joshjennings98">here</a>.</li><li>My LinkedIn is available <a href="https://www.linkedin.com/in/josh-jennings-41a17213a/">here</a>.</li><li>A copy of my CV is available <a href="https://joshj.dev/cv.html">here</a>.</li><li>I can be contacted via <a href="mailto:josh@joshj.dev">email</a>.</li></ul><p>I hope you enjoy my website as much as <a href="#website">I had making it</a>!!!</p><footer><nav><a href="#">Back to top</a></nav></footer></article></div></section></div></main></body></html>